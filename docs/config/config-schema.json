{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://flywall.dev/schemas/config.json",
  "title": "Flywall Configuration",
  "description": "Config is the top-level structure for the firewall configuration.\nIt defines all aspects of the firewall including interfaces, zones, policies,\nNAT rules, services (DHCP, DNS), VPN integrations, and security features.",
  "type": "object",
  "properties": {
    "anomaly_detection": {
      "$schema": "",
      "title": "",
      "description": "AnomalyConfig configures traffic anomaly detection.",
      "type": "",
      "$ref": "#/$defs/Anomalydetection"
    },
    "api": {
      "$schema": "",
      "title": "",
      "description": "API configuration",
      "type": "",
      "$ref": "#/$defs/Api"
    },
    "audit": {
      "$schema": "",
      "title": "",
      "description": "Audit logging configuration",
      "type": "",
      "$ref": "#/$defs/Audit"
    },
    "ddns": {
      "$schema": "",
      "title": "",
      "description": "Dynamic DNS",
      "type": "",
      "$ref": "#/$defs/Ddns"
    },
    "dhcp": {
      "$schema": "",
      "title": "",
      "description": "DHCPServer configuration.",
      "type": "",
      "$ref": "#/$defs/Dhcp"
    },
    "dns": {
      "$schema": "",
      "title": "",
      "description": "New consolidated DNS config",
      "type": "",
      "$ref": "#/$defs/Dns"
    },
    "dns_server": {
      "$schema": "",
      "title": "",
      "description": "Deprecated: use DNS",
      "type": "",
      "$ref": "#/$defs/Dnsserver"
    },
    "enable_flow_offload": {
      "$schema": "",
      "title": "",
      "description": "Enable hardware flow offloading for improved performance.",
      "type": "boolean",
      "default": false
    },
    "features": {
      "$schema": "",
      "title": "",
      "description": "Feature Flags",
      "type": "",
      "$ref": "#/$defs/Features"
    },
    "frr": {
      "$schema": "",
      "title": "",
      "description": "FRRConfig holds configuration for Free Range Routing (FRR).",
      "type": "",
      "$ref": "#/$defs/Frr"
    },
    "geoip": {
      "$schema": "",
      "title": "",
      "description": "GeoIP configuration for country-based filtering",
      "type": "",
      "$ref": "#/$defs/Geoip"
    },
    "interface": {
      "$schema": "",
      "title": "",
      "description": "Interface represents a physical or virtual network interface configuration.\nEach interface can be assigned to a security zone and configured with\nstatic IPs, DHCP, VLANs, and other network settings.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Interface"
      }
    },
    "ip_forwarding": {
      "$schema": "",
      "title": "",
      "description": "Enable IP forwarding between interfaces (required for routing).",
      "type": "boolean",
      "default": false
    },
    "ipset": {
      "$schema": "",
      "title": "",
      "description": "IPSet defines a named set of IPs/networks for use in firewall rules.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Ipset"
      }
    },
    "mark_rule": {
      "$schema": "",
      "title": "",
      "description": "MarkRule represents a rule for setting routing marks on packets.\nMarks are set in nftables and matched by ip rule for routing decisions.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Markrule"
      }
    },
    "mdns": {
      "$schema": "",
      "title": "",
      "description": "mDNS Reflector configuration",
      "type": "",
      "$ref": "#/$defs/Mdns"
    },
    "mss_clamping": {
      "$schema": "",
      "title": "",
      "description": "Enable TCP MSS clamping to PMTU (recommended for VPNs).",
      "type": "boolean",
      "default": false
    },
    "multi_wan": {
      "$schema": "",
      "title": "",
      "description": "MultiWAN represents multi-WAN configuration for failover and load balancing.",
      "type": "",
      "$ref": "#/$defs/Multiwan"
    },
    "nat": {
      "$schema": "",
      "title": "",
      "description": "NATRule defines Network Address Translation rules.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Nat"
      }
    },
    "notifications": {
      "$schema": "",
      "title": "",
      "description": "NotificationsConfig configures the notification system.",
      "type": "",
      "$ref": "#/$defs/Notifications"
    },
    "ntp": {
      "$schema": "",
      "title": "",
      "description": "NTP configuration",
      "type": "",
      "$ref": "#/$defs/Ntp"
    },
    "policy": {
      "$schema": "",
      "title": "",
      "description": "Policy defines traffic rules between zones.\nRules are evaluated in order - first match wins.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Policy"
      }
    },
    "policy_route": {
      "$schema": "",
      "title": "",
      "description": "PolicyRoute represents a policy-based routing rule.\nPolicy routes use firewall marks to direct traffic to specific routing tables.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Policyroute"
      }
    },
    "protection": {
      "$schema": "",
      "title": "",
      "description": "InterfaceProtection defines security protection settings for an interface.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Protection"
      }
    },
    "qos_policy": {
      "$schema": "",
      "title": "",
      "description": "Per-interface settings (first-class)",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Qospolicy"
      }
    },
    "replication": {
      "$schema": "",
      "title": "",
      "description": "State Replication configuration",
      "type": "",
      "$ref": "#/$defs/Replication"
    },
    "route": {
      "$schema": "",
      "title": "",
      "description": "Route represents a static route configuration.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Route"
      }
    },
    "routing_table": {
      "$schema": "",
      "title": "",
      "description": "RoutingTable represents a custom routing table configuration.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Routingtable"
      }
    },
    "rule_learning": {
      "$schema": "",
      "title": "",
      "description": "Rule learning and notifications",
      "type": "",
      "$ref": "#/$defs/Rulelearning"
    },
    "scheduled_rule": {
      "$schema": "",
      "title": "",
      "description": "ScheduledRule defines a firewall rule that activates on a schedule.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Scheduledrule"
      }
    },
    "scheduler": {
      "$schema": "",
      "title": "",
      "description": "SchedulerConfig defines scheduler settings.",
      "type": "",
      "$ref": "#/$defs/Scheduler"
    },
    "schema_version": {
      "$schema": "",
      "title": "",
      "description": "Schema version for backward compatibility.",
      "type": "string",
      "enum": [
        "1.0"
      ],
      "default": "1.0",
      "examples": [
        "\"1.0\""
      ]
    },
    "state_dir": {
      "$schema": "",
      "title": "",
      "description": "State Directory (overrides default /var/lib/flywall)",
      "type": "string"
    },
    "syslog": {
      "$schema": "",
      "title": "",
      "description": "Syslog remote logging",
      "type": "",
      "$ref": "#/$defs/Syslog"
    },
    "system": {
      "$schema": "",
      "title": "",
      "description": "System tuning and settings",
      "type": "",
      "$ref": "#/$defs/System"
    },
    "threat_intel": {
      "$schema": "",
      "title": "",
      "description": "ThreatIntel configures threat intelligence feeds.",
      "type": "",
      "$ref": "#/$defs/Threatintel"
    },
    "uid_routing": {
      "$schema": "",
      "title": "",
      "description": "UIDRouting configures per-user routing (for SOCKS proxies, etc.).",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Uidrouting"
      }
    },
    "uplink_group": {
      "$schema": "",
      "title": "",
      "description": "UplinkGroup configures a group of uplinks (WAN, VPN, etc.) with failover/load balancing.\nThis enables dynamic switching between uplinks while preserving existing connections.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Uplinkgroup"
      }
    },
    "upnp": {
      "$schema": "",
      "title": "",
      "description": "UPnP IGD configuration",
      "type": "",
      "$ref": "#/$defs/Upnp"
    },
    "vpn": {
      "$schema": "",
      "title": "",
      "description": "VPN integrations (Tailscale, WireGuard, etc.) for secure remote access",
      "type": "",
      "$ref": "#/$defs/Vpn"
    },
    "web": {
      "$schema": "",
      "title": "",
      "description": "Web Server configuration (previously part of API)",
      "type": "",
      "$ref": "#/$defs/Web"
    },
    "zone": {
      "$schema": "",
      "title": "",
      "description": "Zone defines a network security zone.\nZones can match traffic by interface, source/destination IP, VLAN, or combinations.\nSimple zones use top-level fields, complex zones use match blocks.",
      "type": "array",
      "items": {
        "$schema": "",
        "title": "",
        "type": "",
        "$ref": "#/$defs/Zone"
      }
    }
  },
  "$defs": {
    "Anomalydetection": {
      "$schema": "",
      "title": "AnomalyConfig",
      "description": "AnomalyConfig configures traffic anomaly detection.",
      "type": "object",
      "properties": {
        "alert_cooldown": {
          "$schema": "",
          "title": "",
          "description": "e.g., \"15m\"",
          "type": "string"
        },
        "baseline_window": {
          "$schema": "",
          "title": "",
          "description": "e.g., \"7d\"",
          "type": "string"
        },
        "drop_stddev": {
          "$schema": "",
          "title": "",
          "description": "Alert if \u003c N stddev",
          "type": "number"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "min_samples": {
          "$schema": "",
          "title": "",
          "description": "Min hits before alerting",
          "type": "number"
        },
        "port_scan_threshold": {
          "$schema": "",
          "title": "",
          "description": "Ports hit before alert",
          "type": "number"
        },
        "spike_stddev": {
          "$schema": "",
          "title": "",
          "description": "Alert if \u003e N stddev",
          "type": "number"
        }
      }
    },
    "Api": {
      "$schema": "",
      "title": "API",
      "description": "API configuration",
      "type": "object",
      "properties": {
        "bootstrap_key": {
          "$schema": "",
          "title": "",
          "description": "Bootstrap key (for initial setup, should be removed after creating real keys)",
          "type": "string"
        },
        "cors_origins": {
          "$schema": "",
          "title": "",
          "description": "CORS settings",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "disable_http_redirect": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: use web.disable_redirect",
          "type": "boolean",
          "deprecated": true
        },
        "disable_sandbox": {
          "$schema": "",
          "title": "",
          "description": "Default: false (Sandbox Enabled)",
          "type": "boolean"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "key": {
          "$schema": "",
          "title": "",
          "description": "Predefined API keys (for config-based key management)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Keys",
            "description": "Predefined API keys (for config-based key management)",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "allowed_ips": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "allowed_paths": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "description": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "key": {
                "$schema": "",
                "title": "",
                "description": "The actual key value",
                "type": "string"
              },
              "permissions": {
                "$schema": "",
                "title": "",
                "description": "Permission strings",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "rate_limit": {
                "$schema": "",
                "title": "",
                "type": "number"
              }
            },
            "required": [
              "_label_name",
              "key",
              "permissions"
            ]
          }
        },
        "key_store_path": {
          "$schema": "",
          "title": "",
          "description": "API key storage Path to key store file",
          "type": "string"
        },
        "letsencrypt": {
          "$schema": "",
          "title": "LetsEncrypt",
          "description": "Let's Encrypt automatic TLS",
          "type": "object",
          "properties": {
            "cache_dir": {
              "$schema": "",
              "title": "",
              "description": "Certificate cache directory",
              "type": "string"
            },
            "domain": {
              "$schema": "",
              "title": "",
              "description": "Domain name for certificate",
              "type": "string"
            },
            "email": {
              "$schema": "",
              "title": "",
              "description": "Contact email for certificate",
              "type": "string"
            },
            "enabled": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "staging": {
              "$schema": "",
              "title": "",
              "description": "Use staging server for testing",
              "type": "boolean"
            }
          },
          "required": [
            "email",
            "domain"
          ]
        },
        "listen": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: use web.listen",
          "type": "string",
          "deprecated": true
        },
        "require_auth": {
          "$schema": "",
          "title": "",
          "description": "Require API key auth",
          "type": "boolean"
        },
        "tls_cert": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: use web.tls_cert",
          "type": "string",
          "deprecated": true
        },
        "tls_key": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: use web.tls_key",
          "type": "string",
          "deprecated": true
        },
        "tls_listen": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: use web.tls_listen",
          "type": "string",
          "deprecated": true
        }
      }
    },
    "Audit": {
      "$schema": "",
      "title": "Audit",
      "description": "Audit logging configuration",
      "type": "object",
      "properties": {
        "database_path": {
          "$schema": "",
          "title": "",
          "description": "DatabasePath overrides the default audit database location.\nDefault: /var/lib/flywall/audit.db",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "description": "Enabled activates audit logging to SQLite.",
          "type": "boolean"
        },
        "kernel_audit": {
          "$schema": "",
          "title": "",
          "description": "KernelAudit enables writing to the Linux kernel audit log (auditd).\nUseful for compliance with SOC2, HIPAA, etc.\nRequires appropriate capabilities (CAP_AUDIT_WRITE).",
          "type": "boolean"
        },
        "retention_days": {
          "$schema": "",
          "title": "",
          "description": "RetentionDays is the number of days to retain audit events.\nDefault: 90 days.",
          "type": "number"
        }
      }
    },
    "Ddns": {
      "$schema": "",
      "title": "DDNS",
      "description": "Dynamic DNS",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "hostname": {
          "$schema": "",
          "title": "",
          "description": "Hostname to update",
          "type": "string"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "description": "Interface to get IP from",
          "type": "string"
        },
        "interval": {
          "$schema": "",
          "title": "",
          "description": "Update interval in minutes (default: 5)",
          "type": "number"
        },
        "provider": {
          "$schema": "",
          "title": "",
          "description": "duckdns, cloudflare, noip",
          "type": "string"
        },
        "record_id": {
          "$schema": "",
          "title": "",
          "description": "For Cloudflare",
          "type": "string"
        },
        "token": {
          "$schema": "",
          "title": "",
          "description": "API token/password",
          "type": "string"
        },
        "username": {
          "$schema": "",
          "title": "",
          "description": "For providers requiring username",
          "type": "string"
        },
        "zone_id": {
          "$schema": "",
          "title": "",
          "description": "For Cloudflare",
          "type": "string"
        }
      },
      "required": [
        "provider",
        "hostname"
      ]
    },
    "Dhcp": {
      "$schema": "",
      "title": "DHCP",
      "description": "DHCPServer configuration.",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "external_lease_file": {
          "$schema": "",
          "title": "",
          "description": "ExternalLeaseFile is the path to external DHCP server's lease file (for import mode)",
          "type": "string"
        },
        "mode": {
          "$schema": "",
          "title": "",
          "description": "Mode specifies how DHCP server is managed:\n  - \"builtin\" (default): Use Flywall's built-in DHCP server\n  - \"external\": External DHCP server (dnsmasq, isc-dhcp, kea) is in use\n  - \"import\": Import leases from external server for visibility",
          "type": "string"
        },
        "scope": {
          "$schema": "",
          "title": "",
          "description": "DHCPScope defines a DHCP pool.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Scopes",
            "description": "DHCPScope defines a DHCP pool.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "dns": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "dns_v6": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "domain": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "lease_time": {
                "$schema": "",
                "title": "",
                "description": "e.g. \"24h\"",
                "type": "string"
              },
              "options": {
                "$schema": "",
                "title": "",
                "description": "Custom DHCP options using named options or numeric codes (1-255)\nNamed options: dns_server = \"8.8.8.8\", tftp_server = \"tftp.boot\", mtu = \"1500\"\nNumeric codes MUST have type prefix: \"66\" = \"str:tftp.boot\", \"150\" = \"ip:192.168.1.10\"\nAvailable prefixes: ip, str/text, hex, u8, u16, u32, bool",
                "type": "object"
              },
              "range_end": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "range_end_v6": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "range_start": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "range_start_v6": {
                "$schema": "",
                "title": "",
                "description": "IPv6 Support (SLAAC/DHCPv6) For Stateful DHCPv6",
                "type": "string"
              },
              "reservation": {
                "$schema": "",
                "title": "",
                "description": "DHCPReservation defines a static IP assignment for a MAC address.",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Reservations",
                  "description": "DHCPReservation defines a static IP assignment for a MAC address.",
                  "type": "object",
                  "properties": {
                    "_label_mac": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: ",
                      "type": "string"
                    },
                    "description": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    },
                    "hostname": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    },
                    "ip": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    },
                    "options": {
                      "$schema": "",
                      "title": "",
                      "description": "Per-host custom DHCP options (same format as scope options)",
                      "type": "object"
                    },
                    "register_dns": {
                      "$schema": "",
                      "title": "",
                      "description": "DNS integration Auto-register in DNS",
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "_label_mac",
                    "ip"
                  ]
                }
              },
              "router": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "interface",
              "range_start",
              "range_end",
              "router"
            ]
          }
        }
      }
    },
    "Dns": {
      "$schema": "",
      "title": "DNS",
      "description": "New consolidated DNS config",
      "type": "object",
      "properties": {
        "conditional_forward": {
          "$schema": "",
          "title": "",
          "description": "ConditionalForward routes specific domains to specific DNS servers.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "ConditionalForwarders",
            "description": "ConditionalForward routes specific domains to specific DNS servers.",
            "type": "object",
            "properties": {
              "_label_domain": {
                "$schema": "",
                "title": "",
                "description": "Block label: e.g., \"corp.example.com\"",
                "type": "string"
              },
              "servers": {
                "$schema": "",
                "title": "",
                "description": "DNS servers for this domain",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              }
            },
            "required": [
              "_label_domain",
              "servers"
            ]
          }
        },
        "dnssec": {
          "$schema": "",
          "title": "",
          "description": "DNSSEC validation for upstream queries",
          "type": "boolean"
        },
        "egress_filter": {
          "$schema": "",
          "title": "",
          "description": "Egress Filter (DNS Wall)\nIf enabled, firewall blocks outbound traffic to IPs not recently resolved by this DNS server.",
          "type": "boolean"
        },
        "egress_filter_ttl": {
          "$schema": "",
          "title": "",
          "description": "Seconds (default: matches record TTL)",
          "type": "number"
        },
        "forwarders": {
          "$schema": "",
          "title": "",
          "description": "Upstream DNS servers for forwarding mode",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "inspect": {
          "$schema": "",
          "title": "",
          "description": "DNSInspect configures DNS traffic inspection for a zone.\nUsed for transparent interception or passive visibility.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Inspect",
            "description": "DNSInspect configures DNS traffic inspection for a zone.\nUsed for transparent interception or passive visibility.",
            "type": "object",
            "properties": {
              "_label_zone": {
                "$schema": "",
                "title": "",
                "description": "Block label: Zone name (label) - can use wildcards",
                "type": "string"
              },
              "exclude_router": {
                "$schema": "",
                "title": "",
                "description": "ExcludeRouter prevents redirecting the router's own DNS traffic",
                "type": "boolean"
              },
              "mode": {
                "$schema": "",
                "title": "",
                "description": "Mode determines what happens to intercepted traffic:\n  - \"redirect\": DNAT to local DNS server (requires serve block)\n  - \"passive\": Decode \u0026 log queries for visibility (like SNI inspection) Default: \"redirect\"",
                "type": "string"
              }
            },
            "required": [
              "_label_zone"
            ]
          }
        },
        "mode": {
          "$schema": "",
          "title": "",
          "description": "Resolution mode for upstream queries:\n  - \"forward\" (default): Forward queries to upstream DNS servers\n  - \"recursive\": Full recursive resolver with root hints",
          "type": "string"
        },
        "recursive": {
          "$schema": "",
          "title": "Recursive",
          "description": "Recursive resolver settings (when mode = \"recursive\")",
          "type": "object",
          "properties": {
            "aggressive_nsec": {
              "$schema": "",
              "title": "",
              "description": "RFC 8198",
              "type": "boolean"
            },
            "auto_update_root_hints": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "harden_below_nxdomain": {
              "$schema": "",
              "title": "",
              "description": "RFC 8020 compliance",
              "type": "boolean"
            },
            "harden_dnssec_stripped": {
              "$schema": "",
              "title": "",
              "description": "Require DNSSEC if expected",
              "type": "boolean"
            },
            "harden_glue": {
              "$schema": "",
              "title": "",
              "description": "Hardening Validate glue records",
              "type": "boolean"
            },
            "harden_referral_path": {
              "$schema": "",
              "title": "",
              "description": "Validate referral path",
              "type": "boolean"
            },
            "max_concurrent": {
              "$schema": "",
              "title": "",
              "description": "Max concurrent outbound queries",
              "type": "number"
            },
            "max_depth": {
              "$schema": "",
              "title": "",
              "description": "Query settings Max recursion depth (default 30)",
              "type": "number"
            },
            "prefetch": {
              "$schema": "",
              "title": "",
              "description": "Prefetching Prefetch expiring entries",
              "type": "boolean"
            },
            "prefetch_key": {
              "$schema": "",
              "title": "",
              "description": "Prefetch DNSKEY records",
              "type": "boolean"
            },
            "qname_minimisation": {
              "$schema": "",
              "title": "",
              "description": "Privacy RFC 7816",
              "type": "boolean"
            },
            "query_timeout": {
              "$schema": "",
              "title": "",
              "description": "Per-query timeout in ms",
              "type": "number"
            },
            "root_hints_file": {
              "$schema": "",
              "title": "",
              "description": "Root hints for recursive resolution Path to root hints file",
              "type": "string"
            }
          }
        },
        "serve": {
          "$schema": "",
          "title": "",
          "description": "Zone-based serving and inspection",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Serve",
            "description": "Zone-based serving and inspection",
            "type": "object",
            "properties": {
              "_label_zone": {
                "$schema": "",
                "title": "",
                "description": "Block label: Zone name (label) - can use wildcards",
                "type": "string"
              },
              "allowlist": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "authoritative_for": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "blocked_address": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "blocked_ttl": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "blocklist": {
                "$schema": "",
                "title": "",
                "description": "Filtering",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Blocklists",
                  "description": "Filtering",
                  "type": "object",
                  "properties": {
                    "_label_name": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: ",
                      "type": "string"
                    },
                    "enabled": {
                      "$schema": "",
                      "title": "",
                      "type": "boolean"
                    },
                    "file": {
                      "$schema": "",
                      "title": "",
                      "description": "Local file path",
                      "type": "string"
                    },
                    "format": {
                      "$schema": "",
                      "title": "",
                      "description": "hosts, domains, adblock",
                      "type": "string"
                    },
                    "refresh_hours": {
                      "$schema": "",
                      "title": "",
                      "type": "number"
                    },
                    "url": {
                      "$schema": "",
                      "title": "",
                      "description": "URL to fetch blocklist",
                      "type": "string"
                    }
                  },
                  "required": [
                    "_label_name"
                  ]
                }
              },
              "cache_enabled": {
                "$schema": "",
                "title": "",
                "description": "Caching",
                "type": "boolean"
              },
              "cache_max_ttl": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "cache_min_ttl": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "cache_size": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "dhcp_integration": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "dnscrypt_server": {
                "$schema": "",
                "title": "DNSCryptServer",
                "description": "DNSCryptServerConfig configures the DNSCrypt server (serve DNSCrypt to clients).",
                "type": "object",
                "properties": {
                  "cert_file": {
                    "$schema": "",
                    "title": "",
                    "description": "DNSCrypt certificate",
                    "type": "string"
                  },
                  "cert_ttl": {
                    "$schema": "",
                    "title": "",
                    "description": "Certificate TTL in hours",
                    "type": "number"
                  },
                  "enabled": {
                    "$schema": "",
                    "title": "",
                    "type": "boolean"
                  },
                  "es_version": {
                    "$schema": "",
                    "title": "",
                    "description": "Encryption suite: 1=XSalsa20Poly1305, 2=XChacha20Poly1305",
                    "type": "number"
                  },
                  "listen_addr": {
                    "$schema": "",
                    "title": "",
                    "description": "Default: :5443",
                    "type": "string"
                  },
                  "provider_name": {
                    "$schema": "",
                    "title": "",
                    "description": "e.g., \"2.dnscrypt-cert.example.com\"",
                    "type": "string"
                  },
                  "public_key_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "secret_key_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  }
                }
              },
              "doh_server": {
                "$schema": "",
                "title": "DoHServer",
                "description": "Encrypted DNS servers (serve DoH/DoT to clients in this zone)",
                "type": "object",
                "properties": {
                  "cert_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "domain": {
                    "$schema": "",
                    "title": "",
                    "description": "For Let's Encrypt",
                    "type": "string"
                  },
                  "enabled": {
                    "$schema": "",
                    "title": "",
                    "type": "boolean"
                  },
                  "key_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "listen_addr": {
                    "$schema": "",
                    "title": "",
                    "description": "Default: :443",
                    "type": "string"
                  },
                  "path": {
                    "$schema": "",
                    "title": "",
                    "description": "Default: /dns-query",
                    "type": "string"
                  },
                  "use_letsencrypt": {
                    "$schema": "",
                    "title": "",
                    "type": "boolean"
                  }
                }
              },
              "dot_server": {
                "$schema": "",
                "title": "DoTServer",
                "description": "DoTServerConfig configures the DNS-over-TLS server.",
                "type": "object",
                "properties": {
                  "cert_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "enabled": {
                    "$schema": "",
                    "title": "",
                    "type": "boolean"
                  },
                  "key_file": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "listen_addr": {
                    "$schema": "",
                    "title": "",
                    "description": "Default: :853",
                    "type": "string"
                  }
                }
              },
              "expand_hosts": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "host": {
                "$schema": "",
                "title": "",
                "description": "Static entries and zones",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Hosts",
                  "description": "Static entries and zones",
                  "type": "object",
                  "properties": {
                    "_label_ip": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: ",
                      "type": "string"
                    },
                    "hostnames": {
                      "$schema": "",
                      "title": "",
                      "type": "array",
                      "items": {
                        "$schema": "",
                        "title": "",
                        "type": "string"
                      }
                    }
                  },
                  "required": [
                    "_label_ip",
                    "hostnames"
                  ]
                }
              },
              "listen_port": {
                "$schema": "",
                "title": "",
                "description": "Listen configuration Default 53",
                "type": "number"
              },
              "local_domain": {
                "$schema": "",
                "title": "",
                "description": "Local domain configuration",
                "type": "string"
              },
              "negative_cache_ttl": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "query_logging": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "rate_limit_per_sec": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "rebind_protection": {
                "$schema": "",
                "title": "",
                "description": "Security",
                "type": "boolean"
              },
              "zone": {
                "$schema": "",
                "title": "",
                "description": "DNSZone configuration for authoritative zones.",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Zones",
                  "description": "DNSZone configuration for authoritative zones.",
                  "type": "object",
                  "properties": {
                    "_label_name": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: ",
                      "type": "string"
                    },
                    "record": {
                      "$schema": "",
                      "title": "",
                      "description": "DNSRecord configuration.",
                      "type": "array",
                      "items": {
                        "$schema": "",
                        "title": "Records",
                        "description": "DNSRecord configuration.",
                        "type": "object",
                        "properties": {
                          "_label_name": {
                            "$schema": "",
                            "title": "",
                            "description": "Block label: ",
                            "type": "string"
                          },
                          "priority": {
                            "$schema": "",
                            "title": "",
                            "description": "For MX, SRV",
                            "type": "number"
                          },
                          "ttl": {
                            "$schema": "",
                            "title": "",
                            "type": "number"
                          },
                          "type": {
                            "$schema": "",
                            "title": "",
                            "description": "A, AAAA, CNAME, MX, TXT, PTR, SRV",
                            "type": "string"
                          },
                          "value": {
                            "$schema": "",
                            "title": "",
                            "description": "IP or target",
                            "type": "string"
                          }
                        },
                        "required": [
                          "_label_name",
                          "type",
                          "value"
                        ]
                      }
                    }
                  },
                  "required": [
                    "_label_name"
                  ]
                }
              }
            },
            "required": [
              "_label_zone"
            ]
          }
        },
        "upstream_dnscrypt": {
          "$schema": "",
          "title": "",
          "description": "DNSCryptUpstream configures a DNSCrypt upstream server.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDNSCrypt",
            "description": "DNSCryptUpstream configures a DNSCrypt upstream server.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "provider_name": {
                "$schema": "",
                "title": "",
                "description": "Provider name for manual config",
                "type": "string"
              },
              "public_key": {
                "$schema": "",
                "title": "",
                "description": "Server public key (hex)",
                "type": "string"
              },
              "server_addr": {
                "$schema": "",
                "title": "",
                "description": "Server address (IP:port)",
                "type": "string"
              },
              "stamp": {
                "$schema": "",
                "title": "",
                "description": "DNS stamp (sdns://...)",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        },
        "upstream_doh": {
          "$schema": "",
          "title": "",
          "description": "Encrypted DNS upstreams",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDoH",
            "description": "Encrypted DNS upstreams",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "bootstrap": {
                "$schema": "",
                "title": "",
                "description": "IP to use for initial connection",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "description": "Lower = preferred",
                "type": "number"
              },
              "server_name": {
                "$schema": "",
                "title": "",
                "description": "SNI override",
                "type": "string"
              },
              "url": {
                "$schema": "",
                "title": "",
                "description": "e.g., \"https://cloudflare-dns.com/dns-query\"",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "url"
            ]
          }
        },
        "upstream_dot": {
          "$schema": "",
          "title": "",
          "description": "DNSOverTLS configures a DNS-over-TLS upstream server.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDoT",
            "description": "DNSOverTLS configures a DNS-over-TLS upstream server.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "server": {
                "$schema": "",
                "title": "",
                "description": "IP:port or hostname:port",
                "type": "string"
              },
              "server_name": {
                "$schema": "",
                "title": "",
                "description": "For TLS verification",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "server"
            ]
          }
        },
        "upstream_timeout": {
          "$schema": "",
          "title": "",
          "description": "seconds",
          "type": "number"
        }
      }
    },
    "Dnsserver": {
      "$schema": "",
      "title": "DNSServer",
      "description": "Deprecated: use DNS",
      "type": "object",
      "properties": {
        "allowlist": {
          "$schema": "",
          "title": "",
          "description": "Domains that bypass blocklists",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "authoritative_for": {
          "$schema": "",
          "title": "",
          "description": "Return NXDOMAIN for unknown local hosts",
          "type": "string"
        },
        "blocked_address": {
          "$schema": "",
          "title": "",
          "description": "IP to return for blocked (default 0.0.0.0)",
          "type": "string"
        },
        "blocked_ttl": {
          "$schema": "",
          "title": "",
          "description": "TTL for blocked responses",
          "type": "number"
        },
        "blocklist": {
          "$schema": "",
          "title": "",
          "description": "Filtering",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Blocklists",
            "description": "Filtering",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "file": {
                "$schema": "",
                "title": "",
                "description": "Local file path",
                "type": "string"
              },
              "format": {
                "$schema": "",
                "title": "",
                "description": "hosts, domains, adblock",
                "type": "string"
              },
              "refresh_hours": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "url": {
                "$schema": "",
                "title": "",
                "description": "URL to fetch blocklist",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        },
        "cache_enabled": {
          "$schema": "",
          "title": "",
          "description": "Caching",
          "type": "boolean"
        },
        "cache_max_ttl": {
          "$schema": "",
          "title": "",
          "description": "Maximum TTL to cache",
          "type": "number"
        },
        "cache_min_ttl": {
          "$schema": "",
          "title": "",
          "description": "Minimum TTL to cache",
          "type": "number"
        },
        "cache_size": {
          "$schema": "",
          "title": "",
          "description": "Max entries",
          "type": "number"
        },
        "conditional_forward": {
          "$schema": "",
          "title": "",
          "description": "ConditionalForward routes specific domains to specific DNS servers.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "ConditionalForwarders",
            "description": "ConditionalForward routes specific domains to specific DNS servers.",
            "type": "object",
            "properties": {
              "_label_domain": {
                "$schema": "",
                "title": "",
                "description": "Block label: e.g., \"corp.example.com\"",
                "type": "string"
              },
              "servers": {
                "$schema": "",
                "title": "",
                "description": "DNS servers for this domain",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              }
            },
            "required": [
              "_label_domain",
              "servers"
            ]
          }
        },
        "dhcp_integration": {
          "$schema": "",
          "title": "",
          "description": "Auto-register DHCP hostnames",
          "type": "boolean"
        },
        "dnscrypt_server": {
          "$schema": "",
          "title": "DNSCryptServer",
          "description": "Serve DNSCrypt",
          "type": "object",
          "properties": {
            "cert_file": {
              "$schema": "",
              "title": "",
              "description": "DNSCrypt certificate",
              "type": "string"
            },
            "cert_ttl": {
              "$schema": "",
              "title": "",
              "description": "Certificate TTL in hours",
              "type": "number"
            },
            "enabled": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "es_version": {
              "$schema": "",
              "title": "",
              "description": "Encryption suite: 1=XSalsa20Poly1305, 2=XChacha20Poly1305",
              "type": "number"
            },
            "listen_addr": {
              "$schema": "",
              "title": "",
              "description": "Default: :5443",
              "type": "string"
            },
            "provider_name": {
              "$schema": "",
              "title": "",
              "description": "e.g., \"2.dnscrypt-cert.example.com\"",
              "type": "string"
            },
            "public_key_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "secret_key_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            }
          }
        },
        "dnssec": {
          "$schema": "",
          "title": "",
          "description": "Security Validate DNSSEC",
          "type": "boolean"
        },
        "doh_server": {
          "$schema": "",
          "title": "DoHServer",
          "description": "Encrypted DNS - Server (serve DoH/DoT/DNSCrypt to clients) Serve DNS-over-HTTPS",
          "type": "object",
          "properties": {
            "cert_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "domain": {
              "$schema": "",
              "title": "",
              "description": "For Let's Encrypt",
              "type": "string"
            },
            "enabled": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "key_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "listen_addr": {
              "$schema": "",
              "title": "",
              "description": "Default: :443",
              "type": "string"
            },
            "path": {
              "$schema": "",
              "title": "",
              "description": "Default: /dns-query",
              "type": "string"
            },
            "use_letsencrypt": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            }
          }
        },
        "dot_server": {
          "$schema": "",
          "title": "DoTServer",
          "description": "Serve DNS-over-TLS",
          "type": "object",
          "properties": {
            "cert_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "enabled": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "key_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "listen_addr": {
              "$schema": "",
              "title": "",
              "description": "Default: :853",
              "type": "string"
            }
          }
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "expand_hosts": {
          "$schema": "",
          "title": "",
          "description": "Append local domain to simple hostnames",
          "type": "boolean"
        },
        "forwarders": {
          "$schema": "",
          "title": "",
          "description": "Upstream DNS (for forwarding mode)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "host": {
          "$schema": "",
          "title": "",
          "description": "Static entries and zones Static /etc/hosts style entries",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Hosts",
            "description": "Static entries and zones Static /etc/hosts style entries",
            "type": "object",
            "properties": {
              "_label_ip": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "hostnames": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              }
            },
            "required": [
              "_label_ip",
              "hostnames"
            ]
          }
        },
        "listen_on": {
          "$schema": "",
          "title": "",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "listen_port": {
          "$schema": "",
          "title": "",
          "description": "Default 53",
          "type": "number"
        },
        "local_domain": {
          "$schema": "",
          "title": "",
          "description": "Local domain configuration e.g., \"lan\", \"home.arpa\"",
          "type": "string",
          "enum": [
            "lan",
            "home.arpa"
          ]
        },
        "mode": {
          "$schema": "",
          "title": "",
          "description": "Resolution mode:\n  - \"forward\" (default): Forward queries to upstream DNS servers\n  - \"recursive\": Full recursive resolver with root hints\n  - \"external\": External DNS server (dnsmasq, bind, unbound) is in use",
          "type": "string"
        },
        "negative_cache_ttl": {
          "$schema": "",
          "title": "",
          "description": "TTL for NXDOMAIN",
          "type": "number"
        },
        "query_logging": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "rate_limit_per_sec": {
          "$schema": "",
          "title": "",
          "description": "Per-client rate limit",
          "type": "number"
        },
        "rebind_protection": {
          "$schema": "",
          "title": "",
          "description": "Block private IPs in public responses",
          "type": "boolean"
        },
        "recursive": {
          "$schema": "",
          "title": "Recursive",
          "description": "Recursive resolver settings (when mode = \"recursive\")",
          "type": "object",
          "properties": {
            "aggressive_nsec": {
              "$schema": "",
              "title": "",
              "description": "RFC 8198",
              "type": "boolean"
            },
            "auto_update_root_hints": {
              "$schema": "",
              "title": "",
              "type": "boolean"
            },
            "harden_below_nxdomain": {
              "$schema": "",
              "title": "",
              "description": "RFC 8020 compliance",
              "type": "boolean"
            },
            "harden_dnssec_stripped": {
              "$schema": "",
              "title": "",
              "description": "Require DNSSEC if expected",
              "type": "boolean"
            },
            "harden_glue": {
              "$schema": "",
              "title": "",
              "description": "Hardening Validate glue records",
              "type": "boolean"
            },
            "harden_referral_path": {
              "$schema": "",
              "title": "",
              "description": "Validate referral path",
              "type": "boolean"
            },
            "max_concurrent": {
              "$schema": "",
              "title": "",
              "description": "Max concurrent outbound queries",
              "type": "number"
            },
            "max_depth": {
              "$schema": "",
              "title": "",
              "description": "Query settings Max recursion depth (default 30)",
              "type": "number"
            },
            "prefetch": {
              "$schema": "",
              "title": "",
              "description": "Prefetching Prefetch expiring entries",
              "type": "boolean"
            },
            "prefetch_key": {
              "$schema": "",
              "title": "",
              "description": "Prefetch DNSKEY records",
              "type": "boolean"
            },
            "qname_minimisation": {
              "$schema": "",
              "title": "",
              "description": "Privacy RFC 7816",
              "type": "boolean"
            },
            "query_timeout": {
              "$schema": "",
              "title": "",
              "description": "Per-query timeout in ms",
              "type": "number"
            },
            "root_hints_file": {
              "$schema": "",
              "title": "",
              "description": "Root hints for recursive resolution Path to root hints file",
              "type": "string"
            }
          }
        },
        "upstream_dnscrypt": {
          "$schema": "",
          "title": "",
          "description": "DNSCrypt upstreams",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDNSCrypt",
            "description": "DNSCrypt upstreams",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "provider_name": {
                "$schema": "",
                "title": "",
                "description": "Provider name for manual config",
                "type": "string"
              },
              "public_key": {
                "$schema": "",
                "title": "",
                "description": "Server public key (hex)",
                "type": "string"
              },
              "server_addr": {
                "$schema": "",
                "title": "",
                "description": "Server address (IP:port)",
                "type": "string"
              },
              "stamp": {
                "$schema": "",
                "title": "",
                "description": "DNS stamp (sdns://...)",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        },
        "upstream_doh": {
          "$schema": "",
          "title": "",
          "description": "Encrypted DNS - Upstream (client mode) DNS-over-HTTPS upstreams",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDoH",
            "description": "Encrypted DNS - Upstream (client mode) DNS-over-HTTPS upstreams",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "bootstrap": {
                "$schema": "",
                "title": "",
                "description": "IP to use for initial connection",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "description": "Lower = preferred",
                "type": "number"
              },
              "server_name": {
                "$schema": "",
                "title": "",
                "description": "SNI override",
                "type": "string"
              },
              "url": {
                "$schema": "",
                "title": "",
                "description": "e.g., \"https://cloudflare-dns.com/dns-query\"",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "url"
            ]
          }
        },
        "upstream_dot": {
          "$schema": "",
          "title": "",
          "description": "DNS-over-TLS upstreams",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "UpstreamDoT",
            "description": "DNS-over-TLS upstreams",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "server": {
                "$schema": "",
                "title": "",
                "description": "IP:port or hostname:port",
                "type": "string"
              },
              "server_name": {
                "$schema": "",
                "title": "",
                "description": "For TLS verification",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "server"
            ]
          }
        },
        "upstream_timeout": {
          "$schema": "",
          "title": "",
          "description": "seconds",
          "type": "number"
        },
        "zone": {
          "$schema": "",
          "title": "",
          "description": "DNSZone configuration for authoritative zones.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Zones",
            "description": "DNSZone configuration for authoritative zones.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "record": {
                "$schema": "",
                "title": "",
                "description": "DNSRecord configuration.",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Records",
                  "description": "DNSRecord configuration.",
                  "type": "object",
                  "properties": {
                    "_label_name": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: ",
                      "type": "string"
                    },
                    "priority": {
                      "$schema": "",
                      "title": "",
                      "description": "For MX, SRV",
                      "type": "number"
                    },
                    "ttl": {
                      "$schema": "",
                      "title": "",
                      "type": "number"
                    },
                    "type": {
                      "$schema": "",
                      "title": "",
                      "description": "A, AAAA, CNAME, MX, TXT, PTR, SRV",
                      "type": "string"
                    },
                    "value": {
                      "$schema": "",
                      "title": "",
                      "description": "IP or target",
                      "type": "string"
                    }
                  },
                  "required": [
                    "_label_name",
                    "type",
                    "value"
                  ]
                }
              }
            },
            "required": [
              "_label_name"
            ]
          }
        }
      },
      "deprecated": true
    },
    "Features": {
      "$schema": "",
      "title": "Features",
      "description": "Feature Flags",
      "type": "object",
      "properties": {
        "integrity_monitoring": {
          "$schema": "",
          "title": "",
          "description": "Detect and revert external changes",
          "type": "boolean"
        },
        "network_learning": {
          "$schema": "",
          "title": "",
          "description": "Automated rule learning",
          "type": "boolean"
        },
        "qos": {
          "$schema": "",
          "title": "",
          "description": "Traffic Shaping",
          "type": "boolean"
        },
        "threat_intel": {
          "$schema": "",
          "title": "",
          "description": "Phase 5: Threat Intelligence",
          "type": "boolean"
        }
      }
    },
    "Frr": {
      "$schema": "",
      "title": "FRR",
      "description": "FRRConfig holds configuration for Free Range Routing (FRR).",
      "type": "object",
      "properties": {
        "bgp": {
          "$schema": "",
          "title": "BGP",
          "description": "BGP configuration.",
          "type": "object",
          "properties": {
            "asn": {
              "$schema": "",
              "title": "",
              "type": "number"
            },
            "neighbor": {
              "$schema": "",
              "title": "",
              "description": "Neighbor BGP peer configuration.",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "Neighbors",
                "description": "Neighbor BGP peer configuration.",
                "type": "object",
                "properties": {
                  "_label_ip": {
                    "$schema": "",
                    "title": "",
                    "description": "Block label: ",
                    "type": "string"
                  },
                  "remote_asn": {
                    "$schema": "",
                    "title": "",
                    "type": "number"
                  }
                },
                "required": [
                  "_label_ip"
                ]
              }
            },
            "networks": {
              "$schema": "",
              "title": "",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "router_id": {
              "$schema": "",
              "title": "",
              "type": "string"
            }
          }
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "ospf": {
          "$schema": "",
          "title": "OSPF",
          "description": "OSPF configuration.",
          "type": "object",
          "properties": {
            "area": {
              "$schema": "",
              "title": "",
              "description": "OSPFArea configuration.",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "Areas",
                "description": "OSPFArea configuration.",
                "type": "object",
                "properties": {
                  "_label_id": {
                    "$schema": "",
                    "title": "",
                    "description": "Block label: ",
                    "type": "string"
                  },
                  "networks": {
                    "$schema": "",
                    "title": "",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    }
                  }
                },
                "required": [
                  "_label_id"
                ]
              }
            },
            "networks": {
              "$schema": "",
              "title": "",
              "description": "List of CIDRs to advertise",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "router_id": {
              "$schema": "",
              "title": "",
              "type": "string"
            }
          }
        }
      }
    },
    "Geoip": {
      "$schema": "",
      "title": "GeoIP",
      "description": "GeoIP configuration for country-based filtering",
      "type": "object",
      "properties": {
        "auto_update": {
          "$schema": "",
          "title": "",
          "description": "AutoUpdate enables automatic database updates (future feature).",
          "type": "boolean"
        },
        "database_path": {
          "$schema": "",
          "title": "",
          "description": "DatabasePath is the path to the MMDB file (MaxMind or DB-IP format).\nDefault: /var/lib/flywall/geoip/GeoLite2-Country.mmdb\nFor DB-IP: /var/lib/flywall/geoip/dbip-country-lite.mmdb",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "description": "Enabled activates GeoIP matching in firewall rules.",
          "type": "boolean"
        },
        "license_key": {
          "$schema": "",
          "title": "",
          "description": "LicenseKey for premium MaxMind database updates (future feature).\nNot required for DB-IP or GeoLite2 (free tier).",
          "type": "string"
        }
      }
    },
    "Interface": {
      "$schema": "",
      "title": "Interfaces",
      "description": "Interface represents a physical or virtual network interface configuration.\nEach interface can be assigned to a security zone and configured with\nstatic IPs, DHCP, VLANs, and other network settings.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: Name is the system interface name.",
          "type": "string"
        },
        "access_web_ui": {
          "$schema": "",
          "title": "",
          "description": "Web UI / API Access\nDeprecated: Use Management block instead",
          "type": "boolean",
          "deprecated": true
        },
        "bond": {
          "$schema": "",
          "title": "Bond",
          "description": "Bond represents the configuration for a bonding interface.",
          "type": "object",
          "properties": {
            "interfaces": {
              "$schema": "",
              "title": "",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "mode": {
              "$schema": "",
              "title": "",
              "type": "string"
            }
          }
        },
        "description": {
          "$schema": "",
          "title": "",
          "description": "Human-readable description for this interface.",
          "type": "string",
          "examples": [
            "\"WAN Uplink\""
          ]
        },
        "dhcp": {
          "$schema": "",
          "title": "",
          "description": "Enable DHCP client on this interface.",
          "type": "boolean",
          "default": false
        },
        "dhcp_client": {
          "$schema": "",
          "title": "",
          "description": "DHCPClient specifies how DHCP client is managed:\n  - \"builtin\" (default): Use Flywall's built-in DHCP client\n  - \"external\": External DHCP client (udhcpc, dhclient, etc.) manages this interface\n  - \"monitor\": Don't manage DHCP, but monitor interface for IP changes",
          "type": "string"
        },
        "dhcp_v6": {
          "$schema": "",
          "title": "",
          "description": "Enable DHCPv6 client for IPv6 address assignment.",
          "type": "boolean",
          "default": false
        },
        "disable_anti_lockout": {
          "$schema": "",
          "title": "",
          "description": "Anti-Lockout protection (sandbox mode only)\nWhen true, implicit accept rules are created for this interface in the\nhigh-priority flywall-lockout table. This ensures control plane access\nis preserved even if the main firewall ruleset is broken/flushed.\nDefaults to false (protection enabled by default if AccessWebUI is true)",
          "type": "boolean"
        },
        "disabled": {
          "$schema": "",
          "title": "",
          "description": "Temporarily disable this interface (brings it down).",
          "type": "boolean",
          "default": false
        },
        "gateway": {
          "$schema": "",
          "title": "",
          "description": "Default gateway for static IPv4 configuration.",
          "type": "string",
          "examples": [
            "\"192.168.1.254\""
          ]
        },
        "gateway_v6": {
          "$schema": "",
          "title": "",
          "description": "Default gateway for static IPv6 configuration.",
          "type": "string",
          "examples": [
            "\"2001:db8::1\""
          ]
        },
        "ipv4": {
          "$schema": "",
          "title": "",
          "description": "Static IPv4 addresses in CIDR notation.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          },
          "examples": [
            "[\"192.168.1.1/24\"]"
          ]
        },
        "ipv6": {
          "$schema": "",
          "title": "",
          "description": "Static IPv6 addresses in CIDR notation.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          },
          "examples": [
            "[\"2001:db8::1/64\"]"
          ]
        },
        "management": {
          "$schema": "",
          "title": "Management",
          "description": "Management Access (Interface specific overrides)",
          "type": "object",
          "properties": {
            "api": {
              "$schema": "",
              "title": "",
              "description": "Allow API access (used for L7 filtering, implies HTTPS access)",
              "type": "boolean"
            },
            "icmp": {
              "$schema": "",
              "title": "",
              "description": "Allow ping to firewall",
              "type": "boolean"
            },
            "snmp": {
              "$schema": "",
              "title": "",
              "description": "Allow SNMP queries (udp/161)",
              "type": "boolean"
            },
            "ssh": {
              "$schema": "",
              "title": "",
              "description": "Allow SSH access (tcp/22)",
              "type": "boolean"
            },
            "syslog": {
              "$schema": "",
              "title": "",
              "description": "Allow syslog sending (udp/514)",
              "type": "boolean"
            },
            "web": {
              "$schema": "",
              "title": "",
              "description": "Allow Web UI access (tcp/80, tcp/443)",
              "type": "boolean"
            },
            "web_ui": {
              "$schema": "",
              "title": "",
              "description": "Legacy: Allow Web UI access (tcp/80, tcp/443) -\u003e Use Web",
              "type": "boolean"
            }
          }
        },
        "mtu": {
          "$schema": "",
          "title": "",
          "description": "Maximum Transmission Unit size in bytes.",
          "type": "number",
          "default": 1500,
          "minimum": 576,
          "maximum": 9000
        },
        "new_zone": {
          "$schema": "",
          "title": "NewZone",
          "description": "Create and assign a new zone inline.",
          "type": "object",
          "properties": {
            "_label_name": {
              "$schema": "",
              "title": "",
              "description": "Block label: ",
              "type": "string"
            },
            "action": {
              "$schema": "",
              "title": "",
              "description": "Zone behavior\nAction for intra-zone traffic: \"accept\", \"drop\", \"reject\" (default: accept)",
              "type": "string",
              "enum": [
                "accept",
                "reject"
              ]
            },
            "color": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "description": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "dhcp": {
              "$schema": "",
              "title": "",
              "description": "Use DHCP client on this interface",
              "type": "boolean"
            },
            "dst": {
              "$schema": "",
              "title": "",
              "description": "Destination IP/network",
              "type": "string"
            },
            "external": {
              "$schema": "",
              "title": "",
              "description": "External marks this as an external/WAN zone (used for auto-masquerade detection)\nIf not set, detected from: DHCP client enabled, non-RFC1918 address, or \"wan\"/\"external\" in name",
              "type": "boolean"
            },
            "interface": {
              "$schema": "",
              "title": "",
              "description": "Simple match criteria (use for single-interface zones)\nThese are effectively a single implicit match rule\nInterface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" or \"wg*\" matches wg0, wg1...)",
              "type": "string"
            },
            "interfaces": {
              "$schema": "",
              "title": "",
              "description": "DEPRECATED: Use Interface or Matches instead\nWill be auto-converted to Matches with warning",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "deprecated": true
            },
            "ipsets": {
              "$schema": "",
              "title": "",
              "description": "Legacy fields (kept for backwards compat) IPSet names for IP-based membership",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "ipv4": {
              "$schema": "",
              "title": "",
              "description": "IP assignment for simple zones (shorthand - assigns to the interface)",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "ipv6": {
              "$schema": "",
              "title": "",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "management": {
              "$schema": "",
              "title": "Management",
              "description": "Management access FROM this zone to the firewall",
              "type": "object",
              "properties": {
                "api": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow API access (used for L7 filtering, implies HTTPS access)",
                  "type": "boolean"
                },
                "icmp": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow ping to firewall",
                  "type": "boolean"
                },
                "snmp": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow SNMP queries (udp/161)",
                  "type": "boolean"
                },
                "ssh": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow SSH access (tcp/22)",
                  "type": "boolean"
                },
                "syslog": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow syslog sending (udp/514)",
                  "type": "boolean"
                },
                "web": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow Web UI access (tcp/80, tcp/443)",
                  "type": "boolean"
                },
                "web_ui": {
                  "$schema": "",
                  "title": "",
                  "description": "Legacy: Allow Web UI access (tcp/80, tcp/443) -\u003e Use Web",
                  "type": "boolean"
                }
              }
            },
            "match": {
              "$schema": "",
              "title": "",
              "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "Matches",
                "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
                "type": "object",
                "properties": {
                  "dst": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "interface": {
                    "$schema": "",
                    "title": "",
                    "description": "Interface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" matches wg0, wg1...)",
                    "type": "string"
                  },
                  "src": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "vlan": {
                    "$schema": "",
                    "title": "",
                    "type": "number"
                  }
                }
              }
            },
            "networks": {
              "$schema": "",
              "title": "",
              "description": "Direct CIDR ranges",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "services": {
              "$schema": "",
              "title": "Services",
              "description": "Services provided TO this zone (firewall auto-generates rules)\nThese define what the firewall offers to clients in this zone",
              "type": "object",
              "properties": {
                "captive_portal": {
                  "$schema": "",
                  "title": "",
                  "description": "Captive portal / guest access Redirect HTTP to portal",
                  "type": "boolean"
                },
                "dhcp": {
                  "$schema": "",
                  "title": "",
                  "description": "Network services Allow DHCP requests (udp/67-68)",
                  "type": "boolean"
                },
                "dns": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow DNS queries (udp/53, tcp/53)",
                  "type": "boolean"
                },
                "ntp": {
                  "$schema": "",
                  "title": "",
                  "description": "Allow NTP sync (udp/123)",
                  "type": "boolean"
                },
                "port": {
                  "$schema": "",
                  "title": "",
                  "description": "Custom service ports (auto-allow)",
                  "type": "array",
                  "items": {
                    "$schema": "",
                    "title": "CustomPorts",
                    "description": "Custom service ports (auto-allow)",
                    "type": "object",
                    "properties": {
                      "_label_name": {
                        "$schema": "",
                        "title": "",
                        "description": "Block label: ",
                        "type": "string"
                      },
                      "port": {
                        "$schema": "",
                        "title": "",
                        "description": "Port number",
                        "type": "number"
                      },
                      "port_end": {
                        "$schema": "",
                        "title": "",
                        "description": "For port ranges",
                        "type": "number"
                      },
                      "protocol": {
                        "$schema": "",
                        "title": "",
                        "description": "tcp, udp",
                        "type": "string"
                      }
                    },
                    "required": [
                      "_label_name",
                      "protocol",
                      "port"
                    ]
                  }
                }
              }
            },
            "src": {
              "$schema": "",
              "title": "",
              "description": "Source IP/network (e.g., \"192.168.1.0/24\")",
              "type": "string"
            },
            "vlan": {
              "$schema": "",
              "title": "",
              "description": "VLAN tag",
              "type": "number"
            }
          },
          "required": [
            "_label_name"
          ]
        },
        "ra": {
          "$schema": "",
          "title": "",
          "description": "Enable Router Advertisements (for IPv6 server mode).",
          "type": "boolean",
          "default": false
        },
        "table": {
          "$schema": "",
          "title": "",
          "description": "Table specifies the routing table ID for this interface.\nIf set to \u003e 0 (and not 254/main), Flywall will enable split routing:\n- A separate routing table (ID=Table) is created with a default route via Gateway.\n- Incoming connections are marked with the table ID.\n- Reply packets are restored with the mark and routed via the table.\n- Locally initiated traffic marked for this table (e.g. via specific IP) uses the table.",
          "type": "number"
        },
        "tls": {
          "$schema": "",
          "title": "TLS",
          "description": "TLS/Certificate configuration for this interface",
          "type": "object",
          "properties": {
            "cert_file": {
              "$schema": "",
              "title": "",
              "description": "Manual certificate (bring your own)",
              "type": "string"
            },
            "domains": {
              "$schema": "",
              "title": "",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "email": {
              "$schema": "",
              "title": "",
              "description": "ACME (Let's Encrypt) settings",
              "type": "string"
            },
            "hostname": {
              "$schema": "",
              "title": "",
              "description": "For Tailscale mode",
              "type": "string"
            },
            "key_file": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "mode": {
              "$schema": "",
              "title": "",
              "description": "\"self-signed\", \"acme\", \"tailscale\", \"manual\"",
              "type": "string",
              "enum": [
                "self-signed",
                "manual"
              ]
            }
          }
        },
        "vlan": {
          "$schema": "",
          "title": "",
          "description": "VLAN represents a VLAN configuration nested within an interface.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "VLANs",
            "description": "VLAN represents a VLAN configuration nested within an interface.",
            "type": "object",
            "properties": {
              "_label_id": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "description": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "ipv4": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "ipv6": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "new_zone": {
                "$schema": "",
                "title": "NewZone",
                "description": "Create zone inline",
                "type": "object",
                "properties": {
                  "_label_name": {
                    "$schema": "",
                    "title": "",
                    "description": "Block label: ",
                    "type": "string"
                  },
                  "action": {
                    "$schema": "",
                    "title": "",
                    "description": "Zone behavior\nAction for intra-zone traffic: \"accept\", \"drop\", \"reject\" (default: accept)",
                    "type": "string",
                    "enum": [
                      "accept",
                      "reject"
                    ]
                  },
                  "color": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "description": {
                    "$schema": "",
                    "title": "",
                    "type": "string"
                  },
                  "dhcp": {
                    "$schema": "",
                    "title": "",
                    "description": "Use DHCP client on this interface",
                    "type": "boolean"
                  },
                  "dst": {
                    "$schema": "",
                    "title": "",
                    "description": "Destination IP/network",
                    "type": "string"
                  },
                  "external": {
                    "$schema": "",
                    "title": "",
                    "description": "External marks this as an external/WAN zone (used for auto-masquerade detection)\nIf not set, detected from: DHCP client enabled, non-RFC1918 address, or \"wan\"/\"external\" in name",
                    "type": "boolean"
                  },
                  "interface": {
                    "$schema": "",
                    "title": "",
                    "description": "Simple match criteria (use for single-interface zones)\nThese are effectively a single implicit match rule\nInterface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" or \"wg*\" matches wg0, wg1...)",
                    "type": "string"
                  },
                  "interfaces": {
                    "$schema": "",
                    "title": "",
                    "description": "DEPRECATED: Use Interface or Matches instead\nWill be auto-converted to Matches with warning",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    },
                    "deprecated": true
                  },
                  "ipsets": {
                    "$schema": "",
                    "title": "",
                    "description": "Legacy fields (kept for backwards compat) IPSet names for IP-based membership",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    }
                  },
                  "ipv4": {
                    "$schema": "",
                    "title": "",
                    "description": "IP assignment for simple zones (shorthand - assigns to the interface)",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    }
                  },
                  "ipv6": {
                    "$schema": "",
                    "title": "",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    }
                  },
                  "management": {
                    "$schema": "",
                    "title": "Management",
                    "description": "Management access FROM this zone to the firewall",
                    "type": "object",
                    "properties": {
                      "api": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow API access (used for L7 filtering, implies HTTPS access)",
                        "type": "boolean"
                      },
                      "icmp": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow ping to firewall",
                        "type": "boolean"
                      },
                      "snmp": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow SNMP queries (udp/161)",
                        "type": "boolean"
                      },
                      "ssh": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow SSH access (tcp/22)",
                        "type": "boolean"
                      },
                      "syslog": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow syslog sending (udp/514)",
                        "type": "boolean"
                      },
                      "web": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow Web UI access (tcp/80, tcp/443)",
                        "type": "boolean"
                      },
                      "web_ui": {
                        "$schema": "",
                        "title": "",
                        "description": "Legacy: Allow Web UI access (tcp/80, tcp/443) -\u003e Use Web",
                        "type": "boolean"
                      }
                    }
                  },
                  "match": {
                    "$schema": "",
                    "title": "",
                    "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "Matches",
                      "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
                      "type": "object",
                      "properties": {
                        "dst": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        },
                        "interface": {
                          "$schema": "",
                          "title": "",
                          "description": "Interface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" matches wg0, wg1...)",
                          "type": "string"
                        },
                        "src": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        },
                        "vlan": {
                          "$schema": "",
                          "title": "",
                          "type": "number"
                        }
                      }
                    }
                  },
                  "networks": {
                    "$schema": "",
                    "title": "",
                    "description": "Direct CIDR ranges",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "",
                      "type": "string"
                    }
                  },
                  "services": {
                    "$schema": "",
                    "title": "Services",
                    "description": "Services provided TO this zone (firewall auto-generates rules)\nThese define what the firewall offers to clients in this zone",
                    "type": "object",
                    "properties": {
                      "captive_portal": {
                        "$schema": "",
                        "title": "",
                        "description": "Captive portal / guest access Redirect HTTP to portal",
                        "type": "boolean"
                      },
                      "dhcp": {
                        "$schema": "",
                        "title": "",
                        "description": "Network services Allow DHCP requests (udp/67-68)",
                        "type": "boolean"
                      },
                      "dns": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow DNS queries (udp/53, tcp/53)",
                        "type": "boolean"
                      },
                      "ntp": {
                        "$schema": "",
                        "title": "",
                        "description": "Allow NTP sync (udp/123)",
                        "type": "boolean"
                      },
                      "port": {
                        "$schema": "",
                        "title": "",
                        "description": "Custom service ports (auto-allow)",
                        "type": "array",
                        "items": {
                          "$schema": "",
                          "title": "CustomPorts",
                          "description": "Custom service ports (auto-allow)",
                          "type": "object",
                          "properties": {
                            "_label_name": {
                              "$schema": "",
                              "title": "",
                              "description": "Block label: ",
                              "type": "string"
                            },
                            "port": {
                              "$schema": "",
                              "title": "",
                              "description": "Port number",
                              "type": "number"
                            },
                            "port_end": {
                              "$schema": "",
                              "title": "",
                              "description": "For port ranges",
                              "type": "number"
                            },
                            "protocol": {
                              "$schema": "",
                              "title": "",
                              "description": "tcp, udp",
                              "type": "string"
                            }
                          },
                          "required": [
                            "_label_name",
                            "protocol",
                            "port"
                          ]
                        }
                      }
                    }
                  },
                  "src": {
                    "$schema": "",
                    "title": "",
                    "description": "Source IP/network (e.g., \"192.168.1.0/24\")",
                    "type": "string"
                  },
                  "vlan": {
                    "$schema": "",
                    "title": "",
                    "description": "VLAN tag",
                    "type": "number"
                  }
                },
                "required": [
                  "_label_name"
                ]
              },
              "zone": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "required": [
              "_label_id"
            ]
          }
        },
        "web_ui_port": {
          "$schema": "",
          "title": "",
          "description": "Deprecated: Use Management block instead Port to map (external)",
          "type": "number",
          "deprecated": true
        },
        "zone": {
          "$schema": "",
          "title": "",
          "description": "Assign this interface to a security zone.",
          "type": "string",
          "examples": [
            "\"wan\""
          ]
        }
      },
      "required": [
        "_label_name"
      ]
    },
    "Ipset": {
      "$schema": "",
      "title": "IPSets",
      "description": "IPSet defines a named set of IPs/networks for use in firewall rules.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "action": {
          "$schema": "",
          "title": "",
          "description": "drop, reject, log (for auto-generated rules)",
          "type": "string"
        },
        "apply_to": {
          "$schema": "",
          "title": "",
          "description": "input, forward, both (for auto-generated rules)",
          "type": "string"
        },
        "auto_update": {
          "$schema": "",
          "title": "",
          "description": "Enable automatic updates",
          "type": "boolean"
        },
        "description": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "domains": {
          "$schema": "",
          "title": "",
          "description": "Domains for dynamic resolution (only for type=\"dns\")",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "entries": {
          "$schema": "",
          "title": "",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "firehol_list": {
          "$schema": "",
          "title": "",
          "description": "FireHOL import e.g., \"firehol_level1\", \"spamhaus_drop\"",
          "type": "string",
          "enum": [
            "firehol_level1",
            "spamhaus_drop"
          ]
        },
        "match_on_dest": {
          "$schema": "",
          "title": "",
          "description": "Match destination IP",
          "type": "boolean"
        },
        "match_on_source": {
          "$schema": "",
          "title": "",
          "description": "Match source IP (default: true)",
          "type": "boolean"
        },
        "refresh_hours": {
          "$schema": "",
          "title": "",
          "description": "How often to refresh (default: 24)",
          "type": "number"
        },
        "refresh_interval": {
          "$schema": "",
          "title": "",
          "description": "Refresh interval for DNS resolution (e.g., \"5m\", \"1h\") - only for type=\"dns\"",
          "type": "string",
          "enum": [
            "5m",
            "1h"
          ]
        },
        "size": {
          "$schema": "",
          "title": "",
          "description": "Optimization: Pre-allocated size for dynamic sets to prevent resizing (suggested: 65535)",
          "type": "number"
        },
        "type": {
          "$schema": "",
          "title": "",
          "description": "ipv4_addr (default), ipv6_addr, inet_service, or dns",
          "type": "string"
        },
        "url": {
          "$schema": "",
          "title": "",
          "description": "Custom URL for IP list",
          "type": "string"
        }
      },
      "required": [
        "_label_name"
      ]
    },
    "Markrule": {
      "$schema": "",
      "title": "MarkRules",
      "description": "MarkRule represents a rule for setting routing marks on packets.\nMarks are set in nftables and matched by ip rule for routing decisions.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "comment": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "conn_state": {
          "$schema": "",
          "title": "",
          "description": "NEW, ESTABLISHED, etc.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "dst_ip": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "dst_port": {
          "$schema": "",
          "title": "",
          "type": "number"
        },
        "dst_ports": {
          "$schema": "",
          "title": "",
          "description": "Multiple ports",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "number"
          }
        },
        "dst_zone": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "in_interface": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "ipset": {
          "$schema": "",
          "title": "",
          "description": "Match against IPSet",
          "type": "string"
        },
        "mark": {
          "$schema": "",
          "title": "",
          "description": "Mark value to set (hex: 0x10)",
          "type": "string"
        },
        "mask": {
          "$schema": "",
          "title": "",
          "description": "Mask for mark operations",
          "type": "string"
        },
        "out_interface": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "proto": {
          "$schema": "",
          "title": "",
          "description": "Match criteria tcp, udp, icmp, all",
          "type": "string"
        },
        "restore_mark": {
          "$schema": "",
          "title": "",
          "description": "Restore from conntrack",
          "type": "boolean"
        },
        "save_mark": {
          "$schema": "",
          "title": "",
          "description": "Mark behavior Save to conntrack",
          "type": "boolean"
        },
        "src_ip": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "src_port": {
          "$schema": "",
          "title": "",
          "type": "number"
        },
        "src_zone": {
          "$schema": "",
          "title": "",
          "type": "string"
        }
      },
      "required": [
        "_label_name",
        "mark"
      ]
    },
    "Mdns": {
      "$schema": "",
      "title": "MDNS",
      "description": "mDNS Reflector configuration",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "interfaces": {
          "$schema": "",
          "title": "",
          "description": "Interfaces to reflect between",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        }
      }
    },
    "Multiwan": {
      "$schema": "",
      "title": "MultiWAN",
      "description": "MultiWAN represents multi-WAN configuration for failover and load balancing.",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "health_check": {
          "$schema": "",
          "title": "HealthCheck",
          "description": "WANHealth configures health checking for multi-WAN.",
          "type": "object",
          "properties": {
            "http_check": {
              "$schema": "",
              "title": "",
              "description": "URL for HTTP health check",
              "type": "string"
            },
            "interval": {
              "$schema": "",
              "title": "",
              "description": "Check interval in seconds",
              "type": "number"
            },
            "targets": {
              "$schema": "",
              "title": "",
              "description": "IPs to ping",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "threshold": {
              "$schema": "",
              "title": "",
              "description": "Failures before marking down",
              "type": "number"
            },
            "timeout": {
              "$schema": "",
              "title": "",
              "description": "Timeout per check",
              "type": "number"
            }
          }
        },
        "mode": {
          "$schema": "",
          "title": "",
          "description": "\"failover\", \"loadbalance\", \"both\"",
          "type": "string",
          "enum": [
            "failover",
            "both"
          ]
        },
        "wan": {
          "$schema": "",
          "title": "",
          "description": "WANLink represents a WAN connection for multi-WAN.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Connections",
            "description": "WANLink represents a WAN connection for multi-WAN.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "gateway": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "description": "For failover (lower = preferred)",
                "type": "number"
              },
              "weight": {
                "$schema": "",
                "title": "",
                "description": "For load balancing (1-100)",
                "type": "number"
              }
            },
            "required": [
              "_label_name",
              "interface",
              "gateway"
            ]
          }
        }
      }
    },
    "Nat": {
      "$schema": "",
      "title": "NAT",
      "description": "NATRule defines Network Address Translation rules.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "description": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "dest_ip": {
          "$schema": "",
          "title": "",
          "description": "Dest IP match",
          "type": "string"
        },
        "dest_port": {
          "$schema": "",
          "title": "",
          "description": "Dest Port match (supports ranges \"80-90\")",
          "type": "string"
        },
        "hairpin": {
          "$schema": "",
          "title": "",
          "description": "Enable Hairpin NAT (NAT Reflection)",
          "type": "boolean"
        },
        "in_interface": {
          "$schema": "",
          "title": "",
          "description": "for dnat",
          "type": "string"
        },
        "mark": {
          "$schema": "",
          "title": "",
          "description": "FWMark match",
          "type": "number"
        },
        "out_interface": {
          "$schema": "",
          "title": "",
          "description": "for masquerade/snat",
          "type": "string"
        },
        "proto": {
          "$schema": "",
          "title": "",
          "description": "tcp, udp",
          "type": "string"
        },
        "snat_ip": {
          "$schema": "",
          "title": "",
          "description": "for snat (Target IP)",
          "type": "string"
        },
        "src_ip": {
          "$schema": "",
          "title": "",
          "description": "Source IP match",
          "type": "string"
        },
        "to_ip": {
          "$schema": "",
          "title": "",
          "description": "Target IP for DNAT",
          "type": "string"
        },
        "to_port": {
          "$schema": "",
          "title": "",
          "description": "Target Port for DNAT",
          "type": "string"
        },
        "type": {
          "$schema": "",
          "title": "",
          "description": "masquerade, dnat, snat, redirect",
          "type": "string"
        }
      },
      "required": [
        "_label_name",
        "type"
      ]
    },
    "Notifications": {
      "$schema": "",
      "title": "Notifications",
      "description": "NotificationsConfig configures the notification system.",
      "type": "object",
      "properties": {
        "channel": {
          "$schema": "",
          "title": "",
          "description": "NotificationChannel defines a notification destination.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Channels",
            "description": "NotificationChannel defines a notification destination.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "api_token": {
                "$schema": "",
                "title": "",
                "description": "Pushover settings",
                "type": "string"
              },
              "channel": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "from": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "headers": {
                "$schema": "",
                "title": "",
                "type": "object"
              },
              "level": {
                "$schema": "",
                "title": "",
                "description": "critical, warning, info",
                "type": "string"
              },
              "password": {
                "$schema": "",
                "title": "",
                "description": "Generic auth (for ntfy, webhook)",
                "type": "string"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "server": {
                "$schema": "",
                "title": "",
                "description": "ntfy settings",
                "type": "string"
              },
              "smtp_host": {
                "$schema": "",
                "title": "",
                "description": "Email settings",
                "type": "string"
              },
              "smtp_password": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "smtp_port": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "smtp_user": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "sound": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "to": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "topic": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "type": {
                "$schema": "",
                "title": "",
                "description": "email, pushover, slack, discord, ntfy, webhook",
                "type": "string"
              },
              "user_key": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "username": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "webhook_url": {
                "$schema": "",
                "title": "",
                "description": "Webhook/Slack/Discord settings",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "type"
            ]
          }
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "rule": {
          "$schema": "",
          "title": "",
          "description": "AlertRule defines when an alert should be triggered.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Rules",
            "description": "AlertRule defines when an alert should be triggered.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "channels": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "condition": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "cooldown": {
                "$schema": "",
                "title": "",
                "description": "e.g. \"1h\"",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "severity": {
                "$schema": "",
                "title": "",
                "description": "info, warning, critical",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "condition"
            ]
          }
        }
      }
    },
    "Ntp": {
      "$schema": "",
      "title": "NTP",
      "description": "NTP configuration",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "interval": {
          "$schema": "",
          "title": "",
          "description": "Sync interval (e.g. \"4h\")",
          "type": "string"
        },
        "servers": {
          "$schema": "",
          "title": "",
          "description": "Upstream servers",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        }
      }
    },
    "Policy": {
      "$schema": "",
      "title": "Policies",
      "description": "Policy defines traffic rules between zones.\nRules are evaluated in order - first match wins.",
      "type": "object",
      "properties": {
        "_label_from": {
          "$schema": "",
          "title": "",
          "description": "Block label: Source zone name",
          "type": "string"
        },
        "_label_to": {
          "$schema": "",
          "title": "",
          "description": "Block label: Destination zone name",
          "type": "string"
        },
        "action": {
          "$schema": "",
          "title": "",
          "description": "Action for traffic matching this policy (when no specific rule matches)\nValues: \"accept\", \"drop\", \"reject\" (default: drop)",
          "type": "string",
          "enum": [
            "accept",
            "reject"
          ]
        },
        "description": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "disabled": {
          "$schema": "",
          "title": "",
          "description": "Temporarily disable this policy",
          "type": "boolean"
        },
        "inherits": {
          "$schema": "",
          "title": "",
          "description": "Inheritance - allows policies to inherit rules from a parent policy\nChild policies get all parent rules first, then their own additional rules Name of parent policy to inherit from",
          "type": "string"
        },
        "log": {
          "$schema": "",
          "title": "",
          "description": "Log packets matching default action",
          "type": "boolean"
        },
        "log_prefix": {
          "$schema": "",
          "title": "",
          "description": "Prefix for log messages",
          "type": "string"
        },
        "masquerade": {
          "$schema": "",
          "title": "",
          "description": "Masquerade controls NAT for outbound traffic through this policy\nnil = auto (enable when RFC1918 source  non-RFC1918 dest)\ntrue = always masquerade\nfalse = never masquerade",
          "type": "boolean"
        },
        "name": {
          "$schema": "",
          "title": "",
          "description": "Optional descriptive name",
          "type": "string"
        },
        "priority": {
          "$schema": "",
          "title": "",
          "description": "Policy priority (lower = evaluated first)",
          "type": "number"
        },
        "rule": {
          "$schema": "",
          "title": "",
          "description": "PolicyRule defines a specific rule within a policy.\nRules are matched in the order they appear - first match wins.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Rules",
            "description": "PolicyRule defines a specific rule within a policy.\nRules are matched in the order they appear - first match wins.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "action": {
                "$schema": "",
                "title": "",
                "description": "Action accept, drop, reject, jump, return, log",
                "type": "string"
              },
              "comment": {
                "$schema": "",
                "title": "",
                "description": "Metadata",
                "type": "string"
              },
              "conn_state": {
                "$schema": "",
                "title": "",
                "description": "\"new\", \"established\", \"related\", \"invalid\"",
                "type": "string",
                "enum": [
                  "new",
                  "invalid"
                ]
              },
              "counter": {
                "$schema": "",
                "title": "",
                "description": "Named counter for accounting",
                "type": "string"
              },
              "days": {
                "$schema": "",
                "title": "",
                "description": "Days of week: \"Monday\", \"Tuesday\", etc.",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "description": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "dest_country": {
                "$schema": "",
                "title": "",
                "description": "ISO 3166-1 alpha-2 country code",
                "type": "string"
              },
              "dest_ip": {
                "$schema": "",
                "title": "",
                "description": "Destination IP/CIDR",
                "type": "string"
              },
              "dest_ipset": {
                "$schema": "",
                "title": "",
                "description": "Destination IPSet name",
                "type": "string"
              },
              "dest_port": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "dest_ports": {
                "$schema": "",
                "title": "",
                "description": "Multiple ports",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "number"
                }
              },
              "dest_zone": {
                "$schema": "",
                "title": "",
                "description": "Override policy's To zone",
                "type": "string"
              },
              "disabled": {
                "$schema": "",
                "title": "",
                "description": "Temporarily disable this rule",
                "type": "boolean"
              },
              "group": {
                "$schema": "",
                "title": "",
                "description": "UI Organization Section grouping: \"User Access\", \"IoT Isolation\"",
                "type": "string",
                "enum": [
                  "User Access",
                  "IoT Isolation"
                ]
              },
              "id": {
                "$schema": "",
                "title": "",
                "description": "Identity Unique ID for referencing in reorder operations",
                "type": "string"
              },
              "in_interface": {
                "$schema": "",
                "title": "",
                "description": "Match specific input interface",
                "type": "string"
              },
              "insert_after": {
                "$schema": "",
                "title": "",
                "description": "Insert after rule with this ID/name",
                "type": "string"
              },
              "invert_dest": {
                "$schema": "",
                "title": "",
                "description": "Negate destination IP/IPSet match",
                "type": "boolean"
              },
              "invert_src": {
                "$schema": "",
                "title": "",
                "description": "Invert matching (match everything EXCEPT the specified value) Negate source IP/IPSet match",
                "type": "boolean"
              },
              "jump_target": {
                "$schema": "",
                "title": "",
                "description": "Target chain for jump action",
                "type": "string"
              },
              "limit": {
                "$schema": "",
                "title": "",
                "description": "Rate limit e.g. \"10/second\"",
                "type": "string"
              },
              "log": {
                "$schema": "",
                "title": "",
                "description": "Logging \u0026 accounting",
                "type": "boolean"
              },
              "log_level": {
                "$schema": "",
                "title": "",
                "description": "\"debug\", \"info\", \"notice\", \"warning\", \"error\"",
                "type": "string",
                "enum": [
                  "debug",
                  "error"
                ]
              },
              "log_prefix": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "max_connections": {
                "$schema": "",
                "title": "",
                "description": "Connection limiting (prevent abuse/DoS) Max concurrent connections per source",
                "type": "number"
              },
              "order": {
                "$schema": "",
                "title": "",
                "description": "Ordering - rules are processed in order, these help with insertion Explicit order (0 = use array position)",
                "type": "number"
              },
              "out_interface": {
                "$schema": "",
                "title": "",
                "description": "Match specific output interface",
                "type": "string"
              },
              "proto": {
                "$schema": "",
                "title": "",
                "description": "Match conditions",
                "type": "string"
              },
              "services": {
                "$schema": "",
                "title": "",
                "description": "Service names like \"http\", \"ssh\"",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "source_country": {
                "$schema": "",
                "title": "",
                "description": "GeoIP matching (requires MaxMind database) ISO 3166-1 alpha-2 country code (e.g., \"US\", \"CN\")",
                "type": "string",
                "enum": [
                  "US",
                  "CN"
                ]
              },
              "src_ip": {
                "$schema": "",
                "title": "",
                "description": "Source IP/CIDR",
                "type": "string"
              },
              "src_ipset": {
                "$schema": "",
                "title": "",
                "description": "Source IPSet name",
                "type": "string"
              },
              "src_port": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "src_ports": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "number"
                }
              },
              "src_zone": {
                "$schema": "",
                "title": "",
                "description": "Additional match conditions Override policy's From zone",
                "type": "string"
              },
              "tags": {
                "$schema": "",
                "title": "",
                "description": "For grouping/filtering in UI",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "tcp_flags": {
                "$schema": "",
                "title": "",
                "description": "TCP Flags matching (for SYN flood protection, connection state filtering)\nValues: \"syn\", \"syn,!ack\", \"ack\", \"fin\", \"rst\", \"psh\", \"urg\" or combinations\nCommon presets: \"syn\" (new only), \"ack\" (established), \"fin,psh,urg\" (xmas scan)",
                "type": "string",
                "enum": [
                  "syn",
                  "urg"
                ]
              },
              "time_end": {
                "$schema": "",
                "title": "",
                "description": "End time \"HH:MM\" (24h format)",
                "type": "string"
              },
              "time_start": {
                "$schema": "",
                "title": "",
                "description": "Time-of-day matching (uses nftables meta hour/day, requires kernel 5.4+) Start time \"HH:MM\" (24h format)",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "action"
            ]
          }
        }
      },
      "required": [
        "_label_from",
        "_label_to"
      ]
    },
    "Policyroute": {
      "$schema": "",
      "title": "PolicyRoutes",
      "description": "PolicyRoute represents a policy-based routing rule.\nPolicy routes use firewall marks to direct traffic to specific routing tables.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "blackhole": {
          "$schema": "",
          "title": "",
          "description": "Drop matching packets",
          "type": "boolean"
        },
        "comment": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "description": "Default true",
          "type": "boolean"
        },
        "from": {
          "$schema": "",
          "title": "",
          "description": "Source IP/CIDR",
          "type": "string"
        },
        "fwmark": {
          "$schema": "",
          "title": "",
          "description": "Alternative mark syntax",
          "type": "string"
        },
        "iif": {
          "$schema": "",
          "title": "",
          "description": "Input interface",
          "type": "string"
        },
        "mark": {
          "$schema": "",
          "title": "",
          "description": "Match criteria (combined with AND) Firewall mark to match (hex: 0x10)",
          "type": "string"
        },
        "mark_mask": {
          "$schema": "",
          "title": "",
          "description": "Mask for mark matching",
          "type": "string"
        },
        "oif": {
          "$schema": "",
          "title": "",
          "description": "Output interface",
          "type": "string"
        },
        "priority": {
          "$schema": "",
          "title": "",
          "description": "Rule priority (lower = higher priority)",
          "type": "number"
        },
        "prohibit": {
          "$schema": "",
          "title": "",
          "description": "Return ICMP prohibited",
          "type": "boolean"
        },
        "table": {
          "$schema": "",
          "title": "",
          "description": "Action Routing table to use",
          "type": "number"
        },
        "to": {
          "$schema": "",
          "title": "",
          "description": "Destination IP/CIDR",
          "type": "string"
        }
      },
      "required": [
        "_label_name"
      ]
    },
    "Protection": {
      "$schema": "",
      "title": "Protections",
      "description": "InterfaceProtection defines security protection settings for an interface.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "allowed_countries": {
          "$schema": "",
          "title": "",
          "description": "If set, only these allowed",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "anti_spoofing": {
          "$schema": "",
          "title": "",
          "description": "AntiSpoofing drops packets with spoofed source IPs (recommended for WAN)",
          "type": "boolean"
        },
        "blocked_countries": {
          "$schema": "",
          "title": "",
          "description": "ISO country codes",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "bogon_filtering": {
          "$schema": "",
          "title": "",
          "description": "BogonFiltering drops packets from reserved/invalid IP ranges",
          "type": "boolean"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "geo_blocking": {
          "$schema": "",
          "title": "",
          "description": "GeoBlocking blocks traffic from specific countries (requires GeoIP database)",
          "type": "boolean"
        },
        "icmp_burst": {
          "$schema": "",
          "title": "",
          "description": "burst (default: 20)",
          "type": "number"
        },
        "icmp_rate": {
          "$schema": "",
          "title": "",
          "description": "packets/sec (default: 10)",
          "type": "number"
        },
        "icmp_rate_limit": {
          "$schema": "",
          "title": "",
          "description": "ICMPRateLimit limits ICMP packets to prevent ping floods",
          "type": "boolean"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "description": "Interface name or \"*\" for all",
          "type": "string"
        },
        "invalid_packets": {
          "$schema": "",
          "title": "",
          "description": "InvalidPackets drops malformed/invalid packets",
          "type": "boolean"
        },
        "new_conn_burst": {
          "$schema": "",
          "title": "",
          "description": "burst (default: 200)",
          "type": "number"
        },
        "new_conn_rate": {
          "$schema": "",
          "title": "",
          "description": "per second (default: 100)",
          "type": "number"
        },
        "new_conn_rate_limit": {
          "$schema": "",
          "title": "",
          "description": "NewConnRateLimit limits new connections per second",
          "type": "boolean"
        },
        "port_scan_protection": {
          "$schema": "",
          "title": "",
          "description": "PortScanProtection detects and blocks port scanning",
          "type": "boolean"
        },
        "port_scan_threshold": {
          "$schema": "",
          "title": "",
          "description": "ports/sec (default: 10)",
          "type": "number"
        },
        "private_filtering": {
          "$schema": "",
          "title": "",
          "description": "PrivateFiltering drops packets from private IP ranges on WAN (RFC1918)",
          "type": "boolean"
        },
        "syn_flood_burst": {
          "$schema": "",
          "title": "",
          "description": "burst allowance (default: 50)",
          "type": "number"
        },
        "syn_flood_protection": {
          "$schema": "",
          "title": "",
          "description": "SynFloodProtection limits SYN packets to prevent SYN floods",
          "type": "boolean"
        },
        "syn_flood_rate": {
          "$schema": "",
          "title": "",
          "description": "packets/sec (default: 25)",
          "type": "number"
        }
      },
      "required": [
        "_label_name",
        "interface"
      ]
    },
    "Qospolicy": {
      "$schema": "",
      "title": "QoSPolicies",
      "description": "Per-interface settings (first-class)",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "class": {
          "$schema": "",
          "title": "",
          "description": "QoSClass defines a traffic class for QoS.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Classes",
            "description": "QoSClass defines a traffic class for QoS.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "burst": {
                "$schema": "",
                "title": "",
                "description": "Burst size",
                "type": "string"
              },
              "ceil": {
                "$schema": "",
                "title": "",
                "description": "Maximum rate",
                "type": "string"
              },
              "priority": {
                "$schema": "",
                "title": "",
                "description": "1-7, lower is higher priority",
                "type": "number"
              },
              "queue_type": {
                "$schema": "",
                "title": "",
                "description": "\"fq_codel\", \"sfq\", \"pfifo\" (default: fq_codel)",
                "type": "string",
                "enum": [
                  "fq_codel",
                  "pfifo"
                ]
              },
              "rate": {
                "$schema": "",
                "title": "",
                "description": "Guaranteed rate e.g., \"10mbit\" or \"10%\"",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        },
        "direction": {
          "$schema": "",
          "title": "",
          "description": "\"ingress\", \"egress\", \"both\" (default: both)",
          "type": "string",
          "enum": [
            "ingress",
            "both"
          ]
        },
        "download_mbps": {
          "$schema": "",
          "title": "",
          "type": "number"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "description": "Interface to apply QoS",
          "type": "string"
        },
        "rule": {
          "$schema": "",
          "title": "",
          "description": "Traffic classification rules",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Rules",
            "description": "Traffic classification rules",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "class": {
                "$schema": "",
                "title": "",
                "description": "Target QoS class",
                "type": "string"
              },
              "dest_ip": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "dest_port": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "dscp": {
                "$schema": "",
                "title": "",
                "description": "Match DSCP value",
                "type": "string"
              },
              "proto": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "services": {
                "$schema": "",
                "title": "",
                "description": "Service names",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "set_dscp": {
                "$schema": "",
                "title": "",
                "description": "Set DSCP on matching traffic",
                "type": "string"
              },
              "src_ip": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "src_port": {
                "$schema": "",
                "title": "",
                "type": "number"
              },
              "threat_intel": {
                "$schema": "",
                "title": "ThreatIntel",
                "description": "ThreatIntel configures threat intelligence feeds.",
                "type": "object",
                "properties": {
                  "enabled": {
                    "$schema": "",
                    "title": "",
                    "type": "boolean"
                  },
                  "interval": {
                    "$schema": "",
                    "title": "",
                    "description": "e.g. \"1h\"",
                    "type": "string"
                  },
                  "source": {
                    "$schema": "",
                    "title": "",
                    "type": "array",
                    "items": {
                      "$schema": "",
                      "title": "Sources",
                      "type": "object",
                      "properties": {
                        "_label_name": {
                          "$schema": "",
                          "title": "",
                          "description": "Block label: ",
                          "type": "string"
                        },
                        "collection_id": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        },
                        "format": {
                          "$schema": "",
                          "title": "",
                          "description": "\"taxii\", \"text\", \"json\"",
                          "type": "string",
                          "enum": [
                            "taxii",
                            "json"
                          ]
                        },
                        "password": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        },
                        "url": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        },
                        "username": {
                          "$schema": "",
                          "title": "",
                          "type": "string"
                        }
                      },
                      "required": [
                        "_label_name",
                        "url"
                      ]
                    }
                  }
                }
              }
            },
            "required": [
              "_label_name",
              "class"
            ]
          }
        },
        "upload_mbps": {
          "$schema": "",
          "title": "",
          "type": "number"
        }
      },
      "required": [
        "_label_name",
        "interface"
      ]
    },
    "Replication": {
      "$schema": "",
      "title": "Replication",
      "description": "State Replication configuration",
      "type": "object",
      "properties": {
        "ha": {
          "$schema": "",
          "title": "HA",
          "description": "HA configuration for high-availability failover",
          "type": "object",
          "properties": {
            "conntrack_sync": {
              "$schema": "",
              "title": "ConntrackSync",
              "description": "ConntrackSync enables connection state replication via conntrackd",
              "type": "object",
              "properties": {
                "enabled": {
                  "$schema": "",
                  "title": "",
                  "description": "Enabled activates conntrack synchronization",
                  "type": "boolean"
                },
                "expect_sync": {
                  "$schema": "",
                  "title": "",
                  "description": "ExpectSync enables expectation table sync for ALG protocols (FTP, SIP, etc.)",
                  "type": "boolean"
                },
                "interface": {
                  "$schema": "",
                  "title": "",
                  "description": "Interface is the network interface for sync traffic (default: HA peer link)",
                  "type": "string"
                },
                "multicast_group": {
                  "$schema": "",
                  "title": "",
                  "description": "MulticastGroup for sync traffic (default: 225.0.0.50)\nSet to empty string to use unicast mode with peer address",
                  "type": "string"
                },
                "port": {
                  "$schema": "",
                  "title": "",
                  "description": "Port for sync traffic (default: 3780)",
                  "type": "number"
                }
              }
            },
            "enabled": {
              "$schema": "",
              "title": "",
              "description": "Enabled activates HA monitoring and failover",
              "type": "boolean"
            },
            "failback_delay": {
              "$schema": "",
              "title": "",
              "description": "FailbackDelay is seconds to wait before automatic failback (default: 60)",
              "type": "number"
            },
            "failback_mode": {
              "$schema": "",
              "title": "",
              "description": "FailbackMode controls behavior when original primary recovers:\n  \"auto\"   - automatically failback after FailbackDelay\n  \"manual\" - require manual intervention to failback\n  \"never\"  - never failback, new primary stays primary",
              "type": "string"
            },
            "failure_threshold": {
              "$schema": "",
              "title": "",
              "description": "FailureThreshold is missed heartbeats before declaring peer dead (default: 3)",
              "type": "number"
            },
            "heartbeat_interval": {
              "$schema": "",
              "title": "",
              "description": "HeartbeatInterval is seconds between heartbeat messages (default: 1)",
              "type": "number"
            },
            "heartbeat_port": {
              "$schema": "",
              "title": "",
              "description": "HeartbeatPort is the UDP port for HA heartbeat messages (default: 9002)",
              "type": "number"
            },
            "priority": {
              "$schema": "",
              "title": "",
              "description": "Priority determines which node becomes primary (lower = higher priority)\nDefault: 100. Set one node to 50 and another to 150 for deterministic election.",
              "type": "number"
            },
            "virtual_ip": {
              "$schema": "",
              "title": "",
              "description": "Virtual IPs to migrate on failover (for LAN-side gateway addresses)",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "VirtualIPs",
                "description": "Virtual IPs to migrate on failover (for LAN-side gateway addresses)",
                "type": "object",
                "properties": {
                  "address": {
                    "$schema": "",
                    "title": "",
                    "description": "Address is the virtual IP in CIDR notation (e.g., \"192.168.1.1/24\")",
                    "type": "string"
                  },
                  "interface": {
                    "$schema": "",
                    "title": "",
                    "description": "Interface is the network interface to add the VIP to (e.g., \"eth1\")",
                    "type": "string"
                  },
                  "label": {
                    "$schema": "",
                    "title": "",
                    "description": "Label is an optional interface label for the address (e.g., \"eth1:vip\")",
                    "type": "string"
                  }
                },
                "required": [
                  "address",
                  "interface"
                ]
              }
            },
            "virtual_mac": {
              "$schema": "",
              "title": "",
              "description": "Virtual MACs to migrate on failover (for DHCP-assigned WAN interfaces)",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "VirtualMACs",
                "description": "Virtual MACs to migrate on failover (for DHCP-assigned WAN interfaces)",
                "type": "object",
                "properties": {
                  "address": {
                    "$schema": "",
                    "title": "",
                    "description": "Address is the virtual MAC address (e.g., \"02:gc:ic:00:00:01\").\nIf empty, a locally-administered MAC is auto-generated from the interface name.",
                    "type": "string"
                  },
                  "dhcp": {
                    "$schema": "",
                    "title": "",
                    "description": "DHCP indicates this interface uses DHCP. On failover, the backup will\nattempt to reclaim the same DHCP lease by sending a REQUEST with the\nprevious lease's offered IP.",
                    "type": "boolean"
                  },
                  "interface": {
                    "$schema": "",
                    "title": "",
                    "description": "Interface is the network interface to apply the VMAC to (e.g., \"eth0\")",
                    "type": "string"
                  }
                },
                "required": [
                  "interface"
                ]
              }
            }
          }
        },
        "listen_addr": {
          "$schema": "",
          "title": "",
          "description": "Listen address for replication traffic (e.g. \":9000\")",
          "type": "string"
        },
        "mode": {
          "$schema": "",
          "title": "",
          "description": "Mode: \"primary\", \"replica\", or \"standalone\" (default, no HA)",
          "type": "string",
          "enum": [
            "primary",
            "replica"
          ]
        },
        "peer_addr": {
          "$schema": "",
          "title": "",
          "description": "Address of the peer node (used for HA heartbeat - both nodes need this)",
          "type": "string"
        },
        "primary_addr": {
          "$schema": "",
          "title": "",
          "description": "Address of the primary node (only for replica mode)",
          "type": "string"
        },
        "secret_key": {
          "$schema": "",
          "title": "",
          "description": "Secret key for PSK authentication (required for secure replication)",
          "type": "string"
        },
        "tls_ca": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "tls_cert": {
          "$schema": "",
          "title": "",
          "description": "TLS configuration for encrypted replication",
          "type": "string"
        },
        "tls_key": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "tls_mutual": {
          "$schema": "",
          "title": "",
          "description": "Require client certs",
          "type": "boolean"
        }
      },
      "required": [
        "mode"
      ]
    },
    "Route": {
      "$schema": "",
      "title": "Routes",
      "description": "Route represents a static route configuration.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "destination": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "gateway": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "metric": {
          "$schema": "",
          "title": "",
          "description": "Route metric/priority",
          "type": "number"
        },
        "monitor_ip": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "table": {
          "$schema": "",
          "title": "",
          "description": "Routing table ID (default: main)",
          "type": "number"
        }
      },
      "required": [
        "_label_name",
        "destination"
      ]
    },
    "Routingtable": {
      "$schema": "",
      "title": "RoutingTables",
      "description": "RoutingTable represents a custom routing table configuration.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "id": {
          "$schema": "",
          "title": "",
          "description": "Table ID (1-252 for custom tables)",
          "type": "number"
        },
        "route": {
          "$schema": "",
          "title": "",
          "description": "Routes in this table",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Routes",
            "description": "Routes in this table",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "destination": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "gateway": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "metric": {
                "$schema": "",
                "title": "",
                "description": "Route metric/priority",
                "type": "number"
              },
              "monitor_ip": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "table": {
                "$schema": "",
                "title": "",
                "description": "Routing table ID (default: main)",
                "type": "number"
              }
            },
            "required": [
              "_label_name",
              "destination"
            ]
          }
        }
      },
      "required": [
        "_label_name",
        "id"
      ]
    },
    "Rulelearning": {
      "$schema": "",
      "title": "RuleLearning",
      "description": "Rule learning and notifications",
      "type": "object",
      "properties": {
        "auto_approve": {
          "$schema": "",
          "title": "",
          "description": "Auto-approve learned rules (legacy)",
          "type": "boolean"
        },
        "cache_size": {
          "$schema": "",
          "title": "",
          "description": "Flow cache size (default: 10000)",
          "type": "number"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "ignore_networks": {
          "$schema": "",
          "title": "",
          "description": "Networks to ignore from learning",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "inline_mode": {
          "$schema": "",
          "title": "",
          "description": "InlineMode uses nfqueue instead of nflog for packet inspection.\nThis holds packets until a verdict is returned, fixing the \"first packet\" problem\nwhere the first packet of a new flow would be dropped before an allow rule is added.\nTrade-off: Adds latency (~microseconds) and requires the engine to be running.\nRecommended: Enable only during initial learning phase, disable after flows are learned.",
          "type": "boolean"
        },
        "learning_mode": {
          "$schema": "",
          "title": "",
          "description": "TOFU (Trust On First Use) mode",
          "type": "boolean"
        },
        "log_group": {
          "$schema": "",
          "title": "",
          "description": "nflog group (default: 100)",
          "type": "number"
        },
        "rate_limit": {
          "$schema": "",
          "title": "",
          "description": "e.g., \"10/minute\"",
          "type": "string"
        },
        "retention_days": {
          "$schema": "",
          "title": "",
          "description": "How long to keep pending rules",
          "type": "number"
        }
      }
    },
    "Scheduledrule": {
      "$schema": "",
      "title": "ScheduledRules",
      "description": "ScheduledRule defines a firewall rule that activates on a schedule.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "description": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "end_schedule": {
          "$schema": "",
          "title": "",
          "description": "Cron expression for when to disable",
          "type": "string"
        },
        "policy": {
          "$schema": "",
          "title": "",
          "description": "Which policy to modify",
          "type": "string"
        },
        "rule": {
          "$schema": "",
          "title": "Rule",
          "description": "The rule to add/remove",
          "type": "object",
          "properties": {
            "_label_name": {
              "$schema": "",
              "title": "",
              "description": "Block label: ",
              "type": "string"
            },
            "action": {
              "$schema": "",
              "title": "",
              "description": "Action accept, drop, reject, jump, return, log",
              "type": "string"
            },
            "comment": {
              "$schema": "",
              "title": "",
              "description": "Metadata",
              "type": "string"
            },
            "conn_state": {
              "$schema": "",
              "title": "",
              "description": "\"new\", \"established\", \"related\", \"invalid\"",
              "type": "string",
              "enum": [
                "new",
                "invalid"
              ]
            },
            "counter": {
              "$schema": "",
              "title": "",
              "description": "Named counter for accounting",
              "type": "string"
            },
            "days": {
              "$schema": "",
              "title": "",
              "description": "Days of week: \"Monday\", \"Tuesday\", etc.",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "description": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "dest_country": {
              "$schema": "",
              "title": "",
              "description": "ISO 3166-1 alpha-2 country code",
              "type": "string"
            },
            "dest_ip": {
              "$schema": "",
              "title": "",
              "description": "Destination IP/CIDR",
              "type": "string"
            },
            "dest_ipset": {
              "$schema": "",
              "title": "",
              "description": "Destination IPSet name",
              "type": "string"
            },
            "dest_port": {
              "$schema": "",
              "title": "",
              "type": "number"
            },
            "dest_ports": {
              "$schema": "",
              "title": "",
              "description": "Multiple ports",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "number"
              }
            },
            "dest_zone": {
              "$schema": "",
              "title": "",
              "description": "Override policy's To zone",
              "type": "string"
            },
            "disabled": {
              "$schema": "",
              "title": "",
              "description": "Temporarily disable this rule",
              "type": "boolean"
            },
            "group": {
              "$schema": "",
              "title": "",
              "description": "UI Organization Section grouping: \"User Access\", \"IoT Isolation\"",
              "type": "string",
              "enum": [
                "User Access",
                "IoT Isolation"
              ]
            },
            "id": {
              "$schema": "",
              "title": "",
              "description": "Identity Unique ID for referencing in reorder operations",
              "type": "string"
            },
            "in_interface": {
              "$schema": "",
              "title": "",
              "description": "Match specific input interface",
              "type": "string"
            },
            "insert_after": {
              "$schema": "",
              "title": "",
              "description": "Insert after rule with this ID/name",
              "type": "string"
            },
            "invert_dest": {
              "$schema": "",
              "title": "",
              "description": "Negate destination IP/IPSet match",
              "type": "boolean"
            },
            "invert_src": {
              "$schema": "",
              "title": "",
              "description": "Invert matching (match everything EXCEPT the specified value) Negate source IP/IPSet match",
              "type": "boolean"
            },
            "jump_target": {
              "$schema": "",
              "title": "",
              "description": "Target chain for jump action",
              "type": "string"
            },
            "limit": {
              "$schema": "",
              "title": "",
              "description": "Rate limit e.g. \"10/second\"",
              "type": "string"
            },
            "log": {
              "$schema": "",
              "title": "",
              "description": "Logging \u0026 accounting",
              "type": "boolean"
            },
            "log_level": {
              "$schema": "",
              "title": "",
              "description": "\"debug\", \"info\", \"notice\", \"warning\", \"error\"",
              "type": "string",
              "enum": [
                "debug",
                "error"
              ]
            },
            "log_prefix": {
              "$schema": "",
              "title": "",
              "type": "string"
            },
            "max_connections": {
              "$schema": "",
              "title": "",
              "description": "Connection limiting (prevent abuse/DoS) Max concurrent connections per source",
              "type": "number"
            },
            "order": {
              "$schema": "",
              "title": "",
              "description": "Ordering - rules are processed in order, these help with insertion Explicit order (0 = use array position)",
              "type": "number"
            },
            "out_interface": {
              "$schema": "",
              "title": "",
              "description": "Match specific output interface",
              "type": "string"
            },
            "proto": {
              "$schema": "",
              "title": "",
              "description": "Match conditions",
              "type": "string"
            },
            "services": {
              "$schema": "",
              "title": "",
              "description": "Service names like \"http\", \"ssh\"",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "source_country": {
              "$schema": "",
              "title": "",
              "description": "GeoIP matching (requires MaxMind database) ISO 3166-1 alpha-2 country code (e.g., \"US\", \"CN\")",
              "type": "string",
              "enum": [
                "US",
                "CN"
              ]
            },
            "src_ip": {
              "$schema": "",
              "title": "",
              "description": "Source IP/CIDR",
              "type": "string"
            },
            "src_ipset": {
              "$schema": "",
              "title": "",
              "description": "Source IPSet name",
              "type": "string"
            },
            "src_port": {
              "$schema": "",
              "title": "",
              "type": "number"
            },
            "src_ports": {
              "$schema": "",
              "title": "",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "number"
              }
            },
            "src_zone": {
              "$schema": "",
              "title": "",
              "description": "Additional match conditions Override policy's From zone",
              "type": "string"
            },
            "tags": {
              "$schema": "",
              "title": "",
              "description": "For grouping/filtering in UI",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "tcp_flags": {
              "$schema": "",
              "title": "",
              "description": "TCP Flags matching (for SYN flood protection, connection state filtering)\nValues: \"syn\", \"syn,!ack\", \"ack\", \"fin\", \"rst\", \"psh\", \"urg\" or combinations\nCommon presets: \"syn\" (new only), \"ack\" (established), \"fin,psh,urg\" (xmas scan)",
              "type": "string",
              "enum": [
                "syn",
                "urg"
              ]
            },
            "time_end": {
              "$schema": "",
              "title": "",
              "description": "End time \"HH:MM\" (24h format)",
              "type": "string"
            },
            "time_start": {
              "$schema": "",
              "title": "",
              "description": "Time-of-day matching (uses nftables meta hour/day, requires kernel 5.4+) Start time \"HH:MM\" (24h format)",
              "type": "string"
            }
          },
          "required": [
            "_label_name",
            "action"
          ]
        },
        "schedule": {
          "$schema": "",
          "title": "",
          "description": "Cron expression for when to enable",
          "type": "string"
        }
      },
      "required": [
        "_label_name",
        "policy",
        "schedule"
      ]
    },
    "Scheduler": {
      "$schema": "",
      "title": "Scheduler",
      "description": "SchedulerConfig defines scheduler settings.",
      "type": "object",
      "properties": {
        "backup_dir": {
          "$schema": "",
          "title": "",
          "description": "Default: /var/lib/firewall/backups",
          "type": "string"
        },
        "backup_enabled": {
          "$schema": "",
          "title": "",
          "description": "Enable auto backups",
          "type": "boolean"
        },
        "backup_retention_days": {
          "$schema": "",
          "title": "",
          "description": "Default: 7",
          "type": "number"
        },
        "backup_schedule": {
          "$schema": "",
          "title": "",
          "description": "Cron expression, default: \"0 2 * * *\"",
          "type": "string"
        },
        "dns_refresh_hours": {
          "$schema": "",
          "title": "",
          "description": "Default: 24",
          "type": "number"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "ipset_refresh_hours": {
          "$schema": "",
          "title": "",
          "description": "Default: 24",
          "type": "number"
        }
      }
    },
    "Syslog": {
      "$schema": "",
      "title": "Syslog",
      "description": "Syslog remote logging",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "facility": {
          "$schema": "",
          "title": "",
          "description": "Syslog facility (default: 1)",
          "type": "number"
        },
        "host": {
          "$schema": "",
          "title": "",
          "description": "Remote syslog server hostname/IP",
          "type": "string"
        },
        "port": {
          "$schema": "",
          "title": "",
          "description": "Default: 514",
          "type": "number"
        },
        "protocol": {
          "$schema": "",
          "title": "",
          "description": "udp or tcp (default: udp)",
          "type": "string"
        },
        "tag": {
          "$schema": "",
          "title": "",
          "description": "Syslog tag (default: flywall)",
          "type": "string"
        }
      },
      "required": [
        "host"
      ]
    },
    "System": {
      "$schema": "",
      "title": "System",
      "description": "System tuning and settings",
      "type": "object",
      "properties": {
        "sysctl": {
          "$schema": "",
          "title": "",
          "description": "Sysctl allows manual override of sysctl parameters\nApplied after profile tuning",
          "type": "object"
        },
        "sysctl_profile": {
          "$schema": "",
          "title": "",
          "description": "SysctlProfile selects a preset sysctl tuning profile\nOptions: \"default\", \"performance\", \"low-memory\", \"security\"",
          "type": "string",
          "enum": [
            "default",
            "security"
          ]
        },
        "timezone": {
          "$schema": "",
          "title": "",
          "description": "Timezone for scheduled rules (e.g. \"America/Los_Angeles\"). Defaults to \"UTC\".",
          "type": "string"
        }
      }
    },
    "Threatintel": {
      "$schema": "",
      "title": "ThreatIntel",
      "description": "ThreatIntel configures threat intelligence feeds.",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "interval": {
          "$schema": "",
          "title": "",
          "description": "e.g. \"1h\"",
          "type": "string"
        },
        "source": {
          "$schema": "",
          "title": "",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Sources",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "collection_id": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "format": {
                "$schema": "",
                "title": "",
                "description": "\"taxii\", \"text\", \"json\"",
                "type": "string",
                "enum": [
                  "taxii",
                  "json"
                ]
              },
              "password": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "url": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "username": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "url"
            ]
          }
        }
      }
    },
    "Uidrouting": {
      "$schema": "",
      "title": "UIDRouting",
      "description": "UIDRouting configures per-user routing (for SOCKS proxies, etc.).",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "comment": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "description": "Output interface",
          "type": "string"
        },
        "snat_ip": {
          "$schema": "",
          "title": "",
          "description": "IP to SNAT to",
          "type": "string"
        },
        "uid": {
          "$schema": "",
          "title": "",
          "description": "User ID to match",
          "type": "number"
        },
        "uplink": {
          "$schema": "",
          "title": "",
          "description": "Uplink to route through",
          "type": "string"
        },
        "username": {
          "$schema": "",
          "title": "",
          "description": "Username (resolved to UID)",
          "type": "string"
        },
        "vpn_link": {
          "$schema": "",
          "title": "",
          "description": "VPN link to route through",
          "type": "string"
        }
      },
      "required": [
        "_label_name"
      ]
    },
    "Uplinkgroup": {
      "$schema": "",
      "title": "UplinkGroups",
      "description": "UplinkGroup configures a group of uplinks (WAN, VPN, etc.) with failover/load balancing.\nThis enables dynamic switching between uplinks while preserving existing connections.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "failback_delay": {
          "$schema": "",
          "title": "",
          "description": "Seconds before failback",
          "type": "number"
        },
        "failback_mode": {
          "$schema": "",
          "title": "",
          "description": "\"immediate\", \"graceful\", \"manual\", \"never\"",
          "type": "string",
          "enum": [
            "immediate",
            "never"
          ]
        },
        "failover_delay": {
          "$schema": "",
          "title": "",
          "description": "Seconds before failover",
          "type": "number"
        },
        "failover_mode": {
          "$schema": "",
          "title": "",
          "description": "Failover configuration \"immediate\", \"graceful\", \"manual\", \"programmatic\"",
          "type": "string",
          "enum": [
            "immediate",
            "programmatic"
          ]
        },
        "health_check": {
          "$schema": "",
          "title": "HealthCheck",
          "description": "WANHealth configures health checking for multi-WAN.",
          "type": "object",
          "properties": {
            "http_check": {
              "$schema": "",
              "title": "",
              "description": "URL for HTTP health check",
              "type": "string"
            },
            "interval": {
              "$schema": "",
              "title": "",
              "description": "Check interval in seconds",
              "type": "number"
            },
            "targets": {
              "$schema": "",
              "title": "",
              "description": "IPs to ping",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "",
                "type": "string"
              }
            },
            "threshold": {
              "$schema": "",
              "title": "",
              "description": "Failures before marking down",
              "type": "number"
            },
            "timeout": {
              "$schema": "",
              "title": "",
              "description": "Timeout per check",
              "type": "number"
            }
          }
        },
        "load_balance_mode": {
          "$schema": "",
          "title": "",
          "description": "Load balancing configuration \"none\", \"roundrobin\", \"weighted\", \"latency\"",
          "type": "string",
          "enum": [
            "none",
            "latency"
          ]
        },
        "source_interfaces": {
          "$schema": "",
          "title": "",
          "description": "Interfaces for connmark restore",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "source_networks": {
          "$schema": "",
          "title": "",
          "description": "CIDRs that use this group",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "source_zones": {
          "$schema": "",
          "title": "",
          "description": "Zones that use this group",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "sticky_connections": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "uplink": {
          "$schema": "",
          "title": "",
          "description": "UplinkDef defines an uplink within a group.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Uplinks",
            "description": "UplinkDef defines an uplink within a group.",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: e.g., \"wg0\", \"wan1\", \"primary-vpn\"",
                "type": "string"
              },
              "comment": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "gateway": {
                "$schema": "",
                "title": "",
                "description": "Gateway IP (for WANs)",
                "type": "string"
              },
              "health_check_cmd": {
                "$schema": "",
                "title": "",
                "description": "Custom health check (optional) Custom command for health check",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Network interface name",
                "type": "string"
              },
              "local_ip": {
                "$schema": "",
                "title": "",
                "description": "Local IP for SNAT",
                "type": "string"
              },
              "tier": {
                "$schema": "",
                "title": "",
                "description": "Failover tier (0 = primary, 1 = secondary, etc.)",
                "type": "number"
              },
              "type": {
                "$schema": "",
                "title": "",
                "description": "\"wan\", \"wireguard\", \"tailscale\", \"openvpn\", \"ipsec\", \"custom\"",
                "type": "string",
                "enum": [
                  "wan",
                  "custom"
                ]
              },
              "weight": {
                "$schema": "",
                "title": "",
                "description": "Weight within tier for load balancing (1-100)",
                "type": "number"
              }
            },
            "required": [
              "_label_name",
              "interface"
            ]
          }
        }
      },
      "required": [
        "_label_name",
        "source_networks"
      ]
    },
    "Upnp": {
      "$schema": "",
      "title": "UPnP",
      "description": "UPnP IGD configuration",
      "type": "object",
      "properties": {
        "enabled": {
          "$schema": "",
          "title": "",
          "type": "boolean"
        },
        "external_interface": {
          "$schema": "",
          "title": "",
          "description": "WAN interface",
          "type": "string"
        },
        "internal_interfaces": {
          "$schema": "",
          "title": "",
          "description": "LAN interfaces",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "secure_mode": {
          "$schema": "",
          "title": "",
          "description": "Only allow mapping to requesting IP",
          "type": "boolean"
        }
      }
    },
    "Vpn": {
      "$schema": "",
      "title": "VPN",
      "description": "VPN integrations (Tailscale, WireGuard, etc.) for secure remote access",
      "type": "object",
      "properties": {
        "interface_prefix_zones": {
          "$schema": "",
          "title": "",
          "description": "Interface prefix matching for zones (like firehol's \"wg+\" syntax)\nMaps interface prefix to zone name\nExample: {\"wg\": \"vpn\", \"tailscale\": \"tailscale\"} means wg0, wg1 -\u003e vpn zone",
          "type": "object"
        },
        "six_to_four": {
          "$schema": "",
          "title": "",
          "description": "6to4 Tunnels (multiple allowed, usually one)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "SixToFour",
            "description": "6to4 Tunnels (multiple allowed, usually one)",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: ",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "type": "boolean"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Physical interface name (usually WAN)",
                "type": "string"
              },
              "mtu": {
                "$schema": "",
                "title": "",
                "description": "Default 1480",
                "type": "number"
              },
              "zone": {
                "$schema": "",
                "title": "",
                "description": "Zone for the tunnel interface (tun6to4)",
                "type": "string"
              }
            },
            "required": [
              "_label_name",
              "interface"
            ]
          }
        },
        "tailscale": {
          "$schema": "",
          "title": "",
          "description": "Tailscale/Headscale connections (multiple allowed)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Tailscale",
            "description": "Tailscale/Headscale connections (multiple allowed)",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: Connection name (label for multiple connections)",
                "type": "string"
              },
              "accept_routes": {
                "$schema": "",
                "title": "",
                "description": "Accept routes from other Tailscale nodes",
                "type": "boolean"
              },
              "advertise_exit_node": {
                "$schema": "",
                "title": "",
                "description": "Advertise this node as an exit node",
                "type": "boolean"
              },
              "advertise_routes": {
                "$schema": "",
                "title": "",
                "description": "Routes to advertise to Tailscale network",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "auth_key": {
                "$schema": "",
                "title": "",
                "description": "Auth key for unattended setup (or use AuthKeyEnv)",
                "type": "string"
              },
              "auth_key_env": {
                "$schema": "",
                "title": "",
                "description": "Environment variable containing auth key",
                "type": "string"
              },
              "control_url": {
                "$schema": "",
                "title": "",
                "description": "Control server URL (for Headscale)",
                "type": "string"
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "description": "Enable this Tailscale connection",
                "type": "boolean"
              },
              "exit_node": {
                "$schema": "",
                "title": "",
                "description": "Use a specific exit node (Tailscale IP or hostname)",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Interface name (default: tailscale0, or tailscale1, etc. for multiple)",
                "type": "string"
              },
              "management_access": {
                "$schema": "",
                "title": "",
                "description": "Always allow management access via Tailscale (lockout protection)\nThis inserts accept rules BEFORE all other firewall rules",
                "type": "boolean"
              },
              "zone": {
                "$schema": "",
                "title": "",
                "description": "Zone name for this interface (default: tailscale)\nUse same zone name across multiple connections to combine them",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        },
        "wireguard": {
          "$schema": "",
          "title": "",
          "description": "WireGuard connections (multiple allowed)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "WireGuard",
            "description": "WireGuard connections (multiple allowed)",
            "type": "object",
            "properties": {
              "_label_name": {
                "$schema": "",
                "title": "",
                "description": "Block label: Connection name (label for multiple connections)",
                "type": "string"
              },
              "address": {
                "$schema": "",
                "title": "",
                "description": "Interface addresses",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "dns": {
                "$schema": "",
                "title": "",
                "description": "DNS servers to use when connected",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "enabled": {
                "$schema": "",
                "title": "",
                "description": "Enable this WireGuard connection",
                "type": "boolean"
              },
              "fwmark": {
                "$schema": "",
                "title": "",
                "description": "Firewall Mark (fwmark) for routing",
                "type": "number"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Interface name (default: wg0, or wg1, etc. for multiple)",
                "type": "string"
              },
              "listen_port": {
                "$schema": "",
                "title": "",
                "description": "Listen port (default: 51820)",
                "type": "number"
              },
              "management_access": {
                "$schema": "",
                "title": "",
                "description": "Always allow management access via WireGuard (lockout protection)",
                "type": "boolean"
              },
              "mtu": {
                "$schema": "",
                "title": "",
                "description": "MTU (default: 1420)",
                "type": "number"
              },
              "peer": {
                "$schema": "",
                "title": "",
                "description": "Peer configurations",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "Peers",
                  "description": "Peer configurations",
                  "type": "object",
                  "properties": {
                    "_label_name": {
                      "$schema": "",
                      "title": "",
                      "description": "Block label: Peer name (label)",
                      "type": "string"
                    },
                    "allowed_ips": {
                      "$schema": "",
                      "title": "",
                      "description": "Allowed IP ranges for this peer",
                      "type": "array",
                      "items": {
                        "$schema": "",
                        "title": "",
                        "type": "string"
                      }
                    },
                    "endpoint": {
                      "$schema": "",
                      "title": "",
                      "description": "Peer's endpoint (host:port)",
                      "type": "string"
                    },
                    "persistent_keepalive": {
                      "$schema": "",
                      "title": "",
                      "description": "Keepalive interval in seconds (useful for NAT traversal)",
                      "type": "number"
                    },
                    "preshared_key": {
                      "$schema": "",
                      "title": "",
                      "description": "Optional preshared key for additional security",
                      "type": "string"
                    },
                    "public_key": {
                      "$schema": "",
                      "title": "",
                      "description": "Peer's public key",
                      "type": "string"
                    }
                  },
                  "required": [
                    "_label_name",
                    "public_key",
                    "allowed_ips"
                  ]
                }
              },
              "post_down": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "post_up": {
                "$schema": "",
                "title": "",
                "description": "Hooks",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "private_key": {
                "$schema": "",
                "title": "",
                "description": "Private key (or use PrivateKeyFile)",
                "type": "string"
              },
              "private_key_file": {
                "$schema": "",
                "title": "",
                "description": "Path to private key file",
                "type": "string"
              },
              "table": {
                "$schema": "",
                "title": "",
                "description": "Routing Table (default: auto)\nIf set to \"off\" or \"auto\", behaves effectively like standard WG.\nIf set to a table ID/name, routes are added to that table.",
                "type": "string"
              },
              "zone": {
                "$schema": "",
                "title": "",
                "description": "Zone name for this interface (default: vpn)\nUse same zone name across multiple connections to combine them",
                "type": "string"
              }
            },
            "required": [
              "_label_name"
            ]
          }
        }
      }
    },
    "Web": {
      "$schema": "",
      "title": "Web",
      "description": "Web Server configuration (previously part of API)",
      "type": "object",
      "properties": {
        "allow": {
          "$schema": "",
          "title": "",
          "description": "Access Control",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Allow",
            "description": "Access Control",
            "type": "object",
            "properties": {
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Single value fields",
                "type": "string"
              },
              "interfaces": {
                "$schema": "",
                "title": "",
                "description": "List value fields (for brevity)",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "source": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "sources": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              }
            }
          }
        },
        "deny": {
          "$schema": "",
          "title": "",
          "description": "AccessRule defines criteria for allowing or denying access.",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Deny",
            "description": "AccessRule defines criteria for allowing or denying access.",
            "type": "object",
            "properties": {
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Single value fields",
                "type": "string"
              },
              "interfaces": {
                "$schema": "",
                "title": "",
                "description": "List value fields (for brevity)",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              },
              "source": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "sources": {
                "$schema": "",
                "title": "",
                "type": "array",
                "items": {
                  "$schema": "",
                  "title": "",
                  "type": "string"
                }
              }
            }
          }
        },
        "disable_redirect": {
          "$schema": "",
          "title": "",
          "description": "Behavior Disable HTTP-\u003eHTTPS redirect",
          "type": "boolean"
        },
        "listen": {
          "$schema": "",
          "title": "",
          "description": "Listen addresses HTTP listen address (default :80)",
          "type": "string"
        },
        "serve_api": {
          "$schema": "",
          "title": "",
          "description": "Serve API paths (default true)",
          "type": "boolean"
        },
        "serve_ui": {
          "$schema": "",
          "title": "",
          "description": "Serve the dashboard (default true)",
          "type": "boolean"
        },
        "tls_cert": {
          "$schema": "",
          "title": "",
          "description": "TLS Configuration Path to TLS certificate",
          "type": "string"
        },
        "tls_key": {
          "$schema": "",
          "title": "",
          "description": "Path to TLS key",
          "type": "string"
        },
        "tls_listen": {
          "$schema": "",
          "title": "",
          "description": "HTTPS listen address (default :443)",
          "type": "string"
        }
      }
    },
    "Zone": {
      "$schema": "",
      "title": "Zones",
      "description": "Zone defines a network security zone.\nZones can match traffic by interface, source/destination IP, VLAN, or combinations.\nSimple zones use top-level fields, complex zones use match blocks.",
      "type": "object",
      "properties": {
        "_label_name": {
          "$schema": "",
          "title": "",
          "description": "Block label: ",
          "type": "string"
        },
        "action": {
          "$schema": "",
          "title": "",
          "description": "Zone behavior\nAction for intra-zone traffic: \"accept\", \"drop\", \"reject\" (default: accept)",
          "type": "string",
          "enum": [
            "accept",
            "reject"
          ]
        },
        "color": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "description": {
          "$schema": "",
          "title": "",
          "type": "string"
        },
        "dhcp": {
          "$schema": "",
          "title": "",
          "description": "Use DHCP client on this interface",
          "type": "boolean"
        },
        "dst": {
          "$schema": "",
          "title": "",
          "description": "Destination IP/network",
          "type": "string"
        },
        "external": {
          "$schema": "",
          "title": "",
          "description": "External marks this as an external/WAN zone (used for auto-masquerade detection)\nIf not set, detected from: DHCP client enabled, non-RFC1918 address, or \"wan\"/\"external\" in name",
          "type": "boolean"
        },
        "interface": {
          "$schema": "",
          "title": "",
          "description": "Simple match criteria (use for single-interface zones)\nThese are effectively a single implicit match rule\nInterface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" or \"wg*\" matches wg0, wg1...)",
          "type": "string"
        },
        "interfaces": {
          "$schema": "",
          "title": "",
          "description": "DEPRECATED: Use Interface or Matches instead\nWill be auto-converted to Matches with warning",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          },
          "deprecated": true
        },
        "ipsets": {
          "$schema": "",
          "title": "",
          "description": "Legacy fields (kept for backwards compat) IPSet names for IP-based membership",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "ipv4": {
          "$schema": "",
          "title": "",
          "description": "IP assignment for simple zones (shorthand - assigns to the interface)",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "ipv6": {
          "$schema": "",
          "title": "",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "management": {
          "$schema": "",
          "title": "Management",
          "description": "Management access FROM this zone to the firewall",
          "type": "object",
          "properties": {
            "api": {
              "$schema": "",
              "title": "",
              "description": "Allow API access (used for L7 filtering, implies HTTPS access)",
              "type": "boolean"
            },
            "icmp": {
              "$schema": "",
              "title": "",
              "description": "Allow ping to firewall",
              "type": "boolean"
            },
            "snmp": {
              "$schema": "",
              "title": "",
              "description": "Allow SNMP queries (udp/161)",
              "type": "boolean"
            },
            "ssh": {
              "$schema": "",
              "title": "",
              "description": "Allow SSH access (tcp/22)",
              "type": "boolean"
            },
            "syslog": {
              "$schema": "",
              "title": "",
              "description": "Allow syslog sending (udp/514)",
              "type": "boolean"
            },
            "web": {
              "$schema": "",
              "title": "",
              "description": "Allow Web UI access (tcp/80, tcp/443)",
              "type": "boolean"
            },
            "web_ui": {
              "$schema": "",
              "title": "",
              "description": "Legacy: Allow Web UI access (tcp/80, tcp/443) -\u003e Use Web",
              "type": "boolean"
            }
          }
        },
        "match": {
          "$schema": "",
          "title": "",
          "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "Matches",
            "description": "Complex match criteria (OR logic between matches, AND logic within each match)\nGlobal fields above apply to ALL matches as defaults",
            "type": "object",
            "properties": {
              "dst": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "interface": {
                "$schema": "",
                "title": "",
                "description": "Interface can be exact (\"eth0\") or prefix with + or * suffix (\"wg+\" matches wg0, wg1...)",
                "type": "string"
              },
              "src": {
                "$schema": "",
                "title": "",
                "type": "string"
              },
              "vlan": {
                "$schema": "",
                "title": "",
                "type": "number"
              }
            }
          }
        },
        "networks": {
          "$schema": "",
          "title": "",
          "description": "Direct CIDR ranges",
          "type": "array",
          "items": {
            "$schema": "",
            "title": "",
            "type": "string"
          }
        },
        "services": {
          "$schema": "",
          "title": "Services",
          "description": "Services provided TO this zone (firewall auto-generates rules)\nThese define what the firewall offers to clients in this zone",
          "type": "object",
          "properties": {
            "captive_portal": {
              "$schema": "",
              "title": "",
              "description": "Captive portal / guest access Redirect HTTP to portal",
              "type": "boolean"
            },
            "dhcp": {
              "$schema": "",
              "title": "",
              "description": "Network services Allow DHCP requests (udp/67-68)",
              "type": "boolean"
            },
            "dns": {
              "$schema": "",
              "title": "",
              "description": "Allow DNS queries (udp/53, tcp/53)",
              "type": "boolean"
            },
            "ntp": {
              "$schema": "",
              "title": "",
              "description": "Allow NTP sync (udp/123)",
              "type": "boolean"
            },
            "port": {
              "$schema": "",
              "title": "",
              "description": "Custom service ports (auto-allow)",
              "type": "array",
              "items": {
                "$schema": "",
                "title": "CustomPorts",
                "description": "Custom service ports (auto-allow)",
                "type": "object",
                "properties": {
                  "_label_name": {
                    "$schema": "",
                    "title": "",
                    "description": "Block label: ",
                    "type": "string"
                  },
                  "port": {
                    "$schema": "",
                    "title": "",
                    "description": "Port number",
                    "type": "number"
                  },
                  "port_end": {
                    "$schema": "",
                    "title": "",
                    "description": "For port ranges",
                    "type": "number"
                  },
                  "protocol": {
                    "$schema": "",
                    "title": "",
                    "description": "tcp, udp",
                    "type": "string"
                  }
                },
                "required": [
                  "_label_name",
                  "protocol",
                  "port"
                ]
              }
            }
          }
        },
        "src": {
          "$schema": "",
          "title": "",
          "description": "Source IP/network (e.g., \"192.168.1.0/24\")",
          "type": "string"
        },
        "vlan": {
          "$schema": "",
          "title": "",
          "description": "VLAN tag",
          "type": "number"
        }
      },
      "required": [
        "_label_name"
      ]
    }
  }
}